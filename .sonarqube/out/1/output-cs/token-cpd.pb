≠l
:I:\DComics\ComicsIDownload\Log4Net\XmlLayoutSchemaLog4j.cs
	namespace 	
ComicsIDownload
 
{		 
public 

class  
XmlLayoutSchemaLog4j %
:& '
XmlLayoutBase( 5
{ 
private 
static 
readonly 
DateTime  (

s_date1970) 3
=4 5
new6 9
DateTime: B
(B C
$numC G
,G H
$numI J
,J K
$numL M
)M N
;N O
public##  
XmlLayoutSchemaLog4j## #
(### $
)##$ %
:##& '
base##( ,
(##, -
)##- .
{$$ 	
}%% 	
public88  
XmlLayoutSchemaLog4j88 #
(88# $
bool88$ (
locationInfo88) 5
)885 6
:887 8
base889 =
(88= >
locationInfo88> J
)88J K
{99 	
}:: 	
publicHH 
stringHH 
VersionHH 
{II 	
getJJ 
{JJ 
returnJJ 
$strJJ 
;JJ 
}JJ  !
setKK 
{LL 
ifMM 
(MM 
valueMM 
!=MM 
$strMM "
)MM" #
{NN 
throwOO 
newOO 
ArgumentExceptionOO /
(OO/ 0
$strOO0 m
)OOm n
;OOn o
}PP 
}QQ 
}RR 	
overrideuu 
	protecteduu 
voiduu 
	FormatXmluu  )
(uu) *
	XmlWriteruu* 3
writeruu4 :
,uu: ;
LoggingEventuu< H
loggingEventuuI U
)uuU V
{vv 	
ifzz 
(zz 
loggingEventzz 
.zz 
LookupPropertyzz +
(zz+ ,
LoggingEventzz, 8
.zz8 9
HostNamePropertyzz9 I
)zzI J
!=zzK M
nullzzN R
&&zzS U
loggingEvent{{ 
.{{ 
LookupProperty{{ +
({{+ ,
$str{{, >
){{> ?
=={{@ B
null{{C G
){{G H
{|| 
loggingEvent}} 
.}} 
GetProperties}} *
(}}* +
)}}+ ,
[}}, -
$str}}- ?
]}}? @
=}}A B
loggingEvent}}C O
.}}O P
LookupProperty}}P ^
(}}^ _
LoggingEvent}}_ k
.}}k l
HostNameProperty}}l |
)}}| }
;}}} ~
}~~ 
if
ÅÅ 
(
ÅÅ 
loggingEvent
ÅÅ 
.
ÅÅ 
LookupProperty
ÅÅ +
(
ÅÅ+ ,
$str
ÅÅ, 6
)
ÅÅ6 7
==
ÅÅ8 :
null
ÅÅ; ?
&&
ÅÅ@ B
loggingEvent
ÇÇ 
.
ÇÇ 
Domain
ÇÇ #
!=
ÇÇ$ &
null
ÇÇ' +
&&
ÇÇ, .
loggingEvent
ÉÉ 
.
ÉÉ 
Domain
ÉÉ #
.
ÉÉ# $
Length
ÉÉ$ *
>
ÉÉ+ ,
$num
ÉÉ- .
)
ÉÉ. /
{
ÑÑ 
loggingEvent
ÖÖ 
.
ÖÖ 
GetProperties
ÖÖ *
(
ÖÖ* +
)
ÖÖ+ ,
[
ÖÖ, -
$str
ÖÖ- 7
]
ÖÖ7 8
=
ÖÖ9 :
loggingEvent
ÖÖ; G
.
ÖÖG H
Domain
ÖÖH N
;
ÖÖN O
}
ÜÜ 
if
ââ 
(
ââ 
loggingEvent
ââ 
.
ââ 
Identity
ââ %
!=
ââ& (
null
ââ) -
&&
ââ. 0
loggingEvent
ää 
.
ää 
Identity
ää %
.
ää% &
Length
ää& ,
>
ää- .
$num
ää/ 0
&&
ää1 3
loggingEvent
ãã 
.
ãã 
LookupProperty
ãã +
(
ãã+ ,
LoggingEvent
ãã, 8
.
ãã8 9
IdentityProperty
ãã9 I
)
ããI J
==
ããK M
null
ããN R
)
ããR S
{
åå 
loggingEvent
çç 
.
çç 
GetProperties
çç *
(
çç* +
)
çç+ ,
[
çç, -
LoggingEvent
çç- 9
.
çç9 :
IdentityProperty
çç: J
]
ççJ K
=
ççL M
loggingEvent
ççN Z
.
ççZ [
Identity
çç[ c
;
ççc d
}
éé 
if
ëë 
(
ëë 
loggingEvent
ëë 
.
ëë 
UserName
ëë %
!=
ëë& (
null
ëë) -
&&
ëë. 0
loggingEvent
íí 
.
íí 
UserName
íí %
.
íí% &
Length
íí& ,
>
íí- .
$num
íí/ 0
&&
íí1 3
loggingEvent
ìì 
.
ìì 
LookupProperty
ìì +
(
ìì+ ,
LoggingEvent
ìì, 8
.
ìì8 9
UserNameProperty
ìì9 I
)
ììI J
==
ììK M
null
ììN R
)
ììR S
{
îî 
loggingEvent
ïï 
.
ïï 
GetProperties
ïï *
(
ïï* +
)
ïï+ ,
[
ïï, -
LoggingEvent
ïï- 9
.
ïï9 :
UserNameProperty
ïï: J
]
ïïJ K
=
ïïL M
loggingEvent
ïïN Z
.
ïïZ [
UserName
ïï[ c
;
ïïc d
}
ññ 
writer
ôô 
.
ôô 
WriteStartElement
ôô $
(
ôô$ %
$str
ôô% ,
,
ôô, -
$str
ôô. 5
,
ôô5 6
$str
ôô7 >
)
ôô> ?
;
ôô? @
writer
öö 
.
öö "
WriteAttributeString
öö '
(
öö' (
$str
öö( 0
,
öö0 1
loggingEvent
öö2 >
.
öö> ?

LoggerName
öö? I
)
ööI J
;
ööJ K
TimeSpan
°° 
timeSince1970
°° "
=
°°# $
loggingEvent
°°% 1
.
°°1 2
TimeStampUtc
°°2 >
-
°°? @

s_date1970
°°A K
;
°°K L
writer
££ 
.
££ "
WriteAttributeString
££ '
(
££' (
$str
££( 3
,
££3 4

XmlConvert
££5 ?
.
££? @
ToString
££@ H
(
££H I
(
££I J
long
££J N
)
££N O
timeSince1970
££O \
.
££\ ]
TotalMilliseconds
££] n
)
££n o
)
££o p
;
££p q
writer
§§ 
.
§§ "
WriteAttributeString
§§ '
(
§§' (
$str
§§( /
,
§§/ 0
loggingEvent
§§1 =
.
§§= >
Level
§§> C
.
§§C D
DisplayName
§§D O
)
§§O P
;
§§P Q
writer
•• 
.
•• "
WriteAttributeString
•• '
(
••' (
$str
••( 0
,
••0 1
loggingEvent
••2 >
.
••> ?

ThreadName
••? I
)
••I J
;
••J K
writer
®® 
.
®® 
WriteStartElement
®® $
(
®®$ %
$str
®®% ,
,
®®, -
$str
®®. 7
,
®®7 8
$str
®®9 @
)
®®@ A
;
®®A B
	Transform
©© 
.
©© #
WriteEscapedXmlString
©© +
(
©©+ ,
writer
©©, 2
,
©©2 3
loggingEvent
©©4 @
.
©©@ A
RenderedMessage
©©A P
,
©©P Q
this
©©R V
.
©©V W$
InvalidCharReplacement
©©W m
)
©©m n
;
©©n o
writer
™™ 
.
™™ 
WriteEndElement
™™ "
(
™™" #
)
™™# $
;
™™$ %
object
¨¨ 
ndcObj
¨¨ 
=
¨¨ 
loggingEvent
¨¨ (
.
¨¨( )
LookupProperty
¨¨) 7
(
¨¨7 8
$str
¨¨8 =
)
¨¨= >
;
¨¨> ?
if
≠≠ 
(
≠≠ 
ndcObj
≠≠ 
!=
≠≠ 
null
≠≠ 
)
≠≠ 
{
ÆÆ 
string
ØØ 
valueStr
ØØ 
=
ØØ  !
loggingEvent
ØØ" .
.
ØØ. /

Repository
ØØ/ 9
.
ØØ9 :
RendererMap
ØØ: E
.
ØØE F
FindAndRender
ØØF S
(
ØØS T
ndcObj
ØØT Z
)
ØØZ [
;
ØØ[ \
if
±± 
(
±± 
valueStr
±± 
!=
±± 
null
±±  $
&&
±±% '
valueStr
±±( 0
.
±±0 1
Length
±±1 7
>
±±8 9
$num
±±: ;
)
±±; <
{
≤≤ 
writer
¥¥ 
.
¥¥ 
WriteStartElement
¥¥ ,
(
¥¥, -
$str
¥¥- 4
,
¥¥4 5
$str
¥¥6 ;
,
¥¥; <
$str
¥¥= D
)
¥¥D E
;
¥¥E F
	Transform
µµ 
.
µµ #
WriteEscapedXmlString
µµ 3
(
µµ3 4
writer
µµ4 :
,
µµ: ;
valueStr
µµ< D
,
µµD E
this
µµF J
.
µµJ K$
InvalidCharReplacement
µµK a
)
µµa b
;
µµb c
writer
∂∂ 
.
∂∂ 
WriteEndElement
∂∂ *
(
∂∂* +
)
∂∂+ ,
;
∂∂, -
}
∑∑ 
}
∏∏ "
PropertiesDictionary
ªª  

properties
ªª! +
=
ªª, -
loggingEvent
ªª. :
.
ªª: ;
GetProperties
ªª; H
(
ªªH I
)
ªªI J
;
ªªJ K
if
ºº 
(
ºº 

properties
ºº 
.
ºº 
Count
ºº  
>
ºº! "
$num
ºº# $
)
ºº$ %
{
ΩΩ 
writer
ææ 
.
ææ 
WriteStartElement
ææ (
(
ææ( )
$str
ææ) 0
,
ææ0 1
$str
ææ2 >
,
ææ> ?
$str
ææ@ G
)
ææG H
;
ææH I
foreach
øø 
(
øø 
System
øø 
.
øø  
Collections
øø  +
.
øø+ ,
DictionaryEntry
øø, ;
entry
øø< A
in
øøB D

properties
øøE O
)
øøO P
{
¿¿ 
writer
¡¡ 
.
¡¡ 
WriteStartElement
¡¡ ,
(
¡¡, -
$str
¡¡- 4
,
¡¡4 5
$str
¡¡6 <
,
¡¡< =
$str
¡¡> E
)
¡¡E F
;
¡¡F G
writer
¬¬ 
.
¬¬ "
WriteAttributeString
¬¬ /
(
¬¬/ 0
$str
¬¬0 6
,
¬¬6 7
(
¬¬8 9
string
¬¬9 ?
)
¬¬? @
entry
¬¬@ E
.
¬¬E F
Key
¬¬F I
)
¬¬I J
;
¬¬J K
string
≈≈ 
valueStr
≈≈ #
=
≈≈$ %
loggingEvent
≈≈& 2
.
≈≈2 3

Repository
≈≈3 =
.
≈≈= >
RendererMap
≈≈> I
.
≈≈I J
FindAndRender
≈≈J W
(
≈≈W X
entry
≈≈X ]
.
≈≈] ^
Value
≈≈^ c
)
≈≈c d
;
≈≈d e
writer
∆∆ 
.
∆∆ "
WriteAttributeString
∆∆ /
(
∆∆/ 0
$str
∆∆0 7
,
∆∆7 8
valueStr
∆∆9 A
)
∆∆A B
;
∆∆B C
writer
»» 
.
»» 
WriteEndElement
»» *
(
»»* +
)
»»+ ,
;
»», -
}
…… 
writer
   
.
   
WriteEndElement
   &
(
  & '
)
  ' (
;
  ( )
}
ÀÀ 
string
ÕÕ 
exceptionStr
ÕÕ 
=
ÕÕ  !
loggingEvent
ÕÕ" .
.
ÕÕ. / 
GetExceptionString
ÕÕ/ A
(
ÕÕA B
)
ÕÕB C
;
ÕÕC D
if
ŒŒ 
(
ŒŒ 
exceptionStr
ŒŒ 
!=
ŒŒ 
null
ŒŒ  $
&&
ŒŒ% '
exceptionStr
ŒŒ( 4
.
ŒŒ4 5
Length
ŒŒ5 ;
>
ŒŒ< =
$num
ŒŒ> ?
)
ŒŒ? @
{
œœ 
writer
—— 
.
—— 
WriteStartElement
—— (
(
——( )
$str
——) 0
,
——0 1
$str
——2 =
,
——= >
$str
——? F
)
——F G
;
——G H
	Transform
““ 
.
““ #
WriteEscapedXmlString
““ /
(
““/ 0
writer
““0 6
,
““6 7
exceptionStr
““8 D
,
““D E
this
““F J
.
““J K$
InvalidCharReplacement
““K a
)
““a b
;
““b c
writer
”” 
.
”” 
WriteEndElement
”” &
(
””& '
)
””' (
;
””( )
}
‘‘ 
if
÷÷ 
(
÷÷ 
LocationInfo
÷÷ 
)
÷÷ 
{
◊◊ 
LocationInfo
ÿÿ 
locationInfo
ÿÿ )
=
ÿÿ* +
loggingEvent
ÿÿ, 8
.
ÿÿ8 9!
LocationInformation
ÿÿ9 L
;
ÿÿL M
writer
⁄⁄ 
.
⁄⁄ 
WriteStartElement
⁄⁄ (
(
⁄⁄( )
$str
⁄⁄) 0
,
⁄⁄0 1
$str
⁄⁄2 @
,
⁄⁄@ A
$str
⁄⁄B I
)
⁄⁄I J
;
⁄⁄J K
writer
€€ 
.
€€ "
WriteAttributeString
€€ +
(
€€+ ,
$str
€€, 3
,
€€3 4
locationInfo
€€5 A
.
€€A B
	ClassName
€€B K
)
€€K L
;
€€L M
writer
‹‹ 
.
‹‹ "
WriteAttributeString
‹‹ +
(
‹‹+ ,
$str
‹‹, 4
,
‹‹4 5
locationInfo
‹‹6 B
.
‹‹B C

MethodName
‹‹C M
)
‹‹M N
;
‹‹N O
writer
›› 
.
›› "
WriteAttributeString
›› +
(
››+ ,
$str
››, 2
,
››2 3
locationInfo
››4 @
.
››@ A
FileName
››A I
)
››I J
;
››J K
writer
ﬁﬁ 
.
ﬁﬁ "
WriteAttributeString
ﬁﬁ +
(
ﬁﬁ+ ,
$str
ﬁﬁ, 2
,
ﬁﬁ2 3
locationInfo
ﬁﬁ4 @
.
ﬁﬁ@ A

LineNumber
ﬁﬁA K
)
ﬁﬁK L
;
ﬁﬁL M
writer
‡‡ 
.
‡‡ 
WriteEndElement
‡‡ &
(
‡‡& '
)
‡‡' (
;
‡‡( )
}
·· 
writer
„„ 
.
„„ 
WriteEndElement
„„ "
(
„„" #
)
„„# $
;
„„$ %
}
‰‰ 	
}
ÂÂ 
}ÊÊ ò
*I:\DComics\ComicsIDownload\Models\Comic.cs
	namespace 	
DComics
 
. 
Models 
{ 
class 	
Comic
 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[		 	
JsonProperty			 
(		 
$str		 
)		 
]		 
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
[ 	
JsonProperty	 
( 
$str 
) 
] 
public 
string 
Link 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
NameWeb 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
SizeWeb 
{ 
get  #
;# $
set% (
;( )
}* +
public 
Comic 
( 
) 
{ 	
} 	
public 
Comic 
( 
int 
id 
, 
string #
name$ (
,( )
string* 0
link1 5
)5 6
{ 	
Id 
= 
id 
; 
Name 
= 
name 
; 
Link 
= 
link 
; 
} 	
public 
override 
string 
ToString '
(' (
)( )
{ 	
return 
string 
. 
Format  
(  !
$str! \
,\ ]
Id^ `
,` a
Nameb f
,f g
Linkh l
,l m
NameWebn u
,u v
SizeWebw ~
)~ 
;	 Ä
} 	
public 
static 
string 

Serializer '
(' (
List( ,
<, -
Comic- 2
>2 3
comics4 :
,: ;
bool< @
indentedA I
=J K
trueL P
)P Q
{ 	
return   
indented   
?   
JsonConvert   )
.  ) *
SerializeObject  * 9
(  9 :
comics  : @
,  @ A

Formatting  B L
.  L M
Indented  M U
)  U V
:  W X
JsonConvert  Y d
.  d e
SerializeObject  e t
(  t u
comics  u {
,  { |

Formatting	  } á
.
  á à
None
  à å
)
  å ç
;
  ç é
}!! 	
}"" 
}## ˙5
%I:\DComics\ComicsIDownload\Program.cs
	namespace		 	
DComics		
 
{

 
class 	
Program
 
{ 
static 
ILog 
logger 
; 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
logger 
= 

initLogger 
(  
)  !
;! "
int 
option 
= 
$num 
; 
string 
infoAdditional !
=" #
$str$ &
;& '
try 
{ 
MegaApiClient 
mega "
=# $
new% (
MegaApiClient) 6
(6 7
)7 8
;8 9
mega 
. 
LoginAnonymous #
(# $
)$ %
;% &
Services 
services !
=" #
new$ '
Services( 0
(0 1
mega1 5
)5 6
;6 7
logger 
. 
Info 
( 
$str 0
)0 1
;1 2
if 
( 
! 
services 
. $
CheckDirectoriesAndFiles 6
(6 7
logger7 =
)= >
)> ?
{ 
logger 
. 
Info 
(  
$str  G
)G H
;H I
return 
; 
} 
args   
=   
new   
string   !
[  ! "
]  " #
{  $ %
$str  & )
,  ) *
$str  + 6
}  7 8
;  8 9
if!! 
(!! 
args!! 
!=!! 
null!!  
)!!  !
{"" 
option## 
=## 
!## 
string## $
.##$ %
IsNullOrEmpty##% 2
(##2 3
args##3 7
[##7 8
$num##8 9
]##9 :
)##: ;
?##< =
int##> A
.##A B
Parse##B G
(##G H
args##H L
[##L M
$num##M N
]##N O
)##O P
:##Q R
$num##S T
;##T U
infoAdditional$$ "
=$$# $
!$$% &
string$$& ,
.$$, -
IsNullOrEmpty$$- :
($$: ;
args$$; ?
[$$? @
$num$$@ A
]$$A B
)$$B C
?$$D E
args$$F J
[$$J K
$num$$K L
]$$L M
:$$N O
$str$$P R
;$$R S
}%% 
switch&& 
(&& 
option&& 
)&& 
{'' 
case(( 
$num(( 
:(( 
services))  
.))  !
DownloadNews))! -
())- .
logger)). 4
)))4 5
;))5 6
break** 
;** 
case,, 
$num,, 
:,, 
services--  
.--  !
ReadFile--! )
(--) *
infoAdditional--* 8
,--8 9
logger--: @
)--@ A
;--A B
break.. 
;.. 
case00 
$num00 
:00 
services11  
.11  !
RenameFiles11! ,
(11, -
infoAdditional11- ;
,11; <
logger11= C
)11C D
;11D E
break22 
;22 
case44 
$num44 
:44 
services55  
.55  !
ListCollections55! 0
(550 1
logger551 7
)557 8
;558 9
break66 
;66 
case88 
$num88 
:88 
DirectoryInfo99 %
rootDir99& -
=99. /
new990 3
DirectoryInfo994 A
(99A B
$str99B \
)99\ ]
;99] ^
services::  
.::  !
TreeDirectory::! .
(::. /
rootDir::/ 6
,::6 7
new::8 ;
List::< @
<::@ A
string::A G
>::G H
(::H I
)::I J
,::J K
logger::L R
)::R S
;::S T
break;; 
;;; 
case== 
$num== 
:== 
services>>  
.>>  !
ListCollections>>! 0
(>>0 1
logger>>1 7
,>>7 8
$str>>9 ?
)>>? @
;>>@ A
break?? 
;?? 
caseAA 
$numAA 
:AA 
servicesBB  
.BB  !
ReadCollectionBB! /
(BB/ 0
$strBB0 ]
,BB] ^
loggerBB_ e
)BBe f
;BBf g
breakCC 
;CC 
caseEE 
$numEE 
:EE 
servicesFF  
.FF  !
ReviewNoDownloadFF! 1
(FF1 2
infoAdditionalFF2 @
,FF@ A
loggerFFB H
)FFH I
;FFI J
breakGG 
;GG 
defaultII 
:II 
returnJJ 
;JJ 
}KK 
loggerLL 
.LL 
InfoLL 
(LL 
$strLL -
)LL- .
;LL. /
megaMM 
.MM 
LogoutMM 
(MM 
)MM 
;MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
ifQQ 
(QQ 
loggerQQ 
!=QQ 
nullQQ "
)QQ" #
loggerRR 
.RR 
ErrorRR  
(RR  !
stringRR! '
.RR' (
FormatRR( .
(RR. /
$strRR/ c
,RRc d

MethodBaseRRe o
.RRo p
GetCurrentMethod	RRp Ä
(
RRÄ Å
)
RRÅ Ç
.
RRÇ É
Name
RRÉ á
,
RRá à
ex
RRâ ã
.
RRã å
Message
RRå ì
)
RRì î
)
RRî ï
;
RRï ñ
}SS 
}TT 	
privateVV 
staticVV 
ILogVV 

initLoggerVV &
(VV& '
)VV' (
{WW 	
varaa 
logRepositoryaa 
=aa 

LogManageraa  *
.aa* +
GetRepositoryaa+ 8
(aa8 9
Assemblyaa9 A
.aaA B
GetEntryAssemblyaaB R
(aaR S
)aaS T
)aaT U
;aaU V
XmlConfiguratorbb 
.bb 
	Configurebb %
(bb% &
logRepositorybb& 3
,bb3 4
newbb5 8
FileInfobb9 A
(bbA B
$strbbB R
)bbR S
)bbS T
;bbT U
returncc 

LogManagercc 
.cc 
	GetLoggercc '
(cc' (
typeofcc( .
(cc. /
Programcc/ 6
)cc6 7
)cc7 8
;cc8 9
}dd 	
}ee 
}ff Ÿ›
/I:\DComics\ComicsIDownload\Services\Services.cs
	namespace 	
DComics
 
{ 
public 

class 
Services 
{ 
int 
count 
= 
$num 
; 
private 
const 
string 
Url  
=! "
$str# C
;C D
private 
readonly 
MegaApiClient &
ApiMega' .
;. /
public 
Services 
( 
MegaApiClient %
mega& *
)* +
{ 	
ApiMega 
= 
mega 
; 
} 	
public 
void 
DownloadNews  
(  !
ILog! %
logger& ,
), -
{   	
try!! 
{"" 
logger## 
.## 
Info## 
(## 
string## "
.##" #
Format### )
(##) *
$str##* F
,##F G

MethodBase##H R
.##R S
GetCurrentMethod##S c
(##c d
)##d e
.##e f
Name##f j
)##j k
)##k l
;##l m
List$$ 
<$$ 
Comic$$ 
>$$ 
news$$  
=$$! "
new$$# &
List$$' +
<$$+ ,
Comic$$, 1
>$$1 2
($$2 3
)$$3 4
;$$4 5
string%% 
nameLastDonwload%% '
=%%( )
ReadLastDownload%%* :
(%%: ;
logger%%; A
)%%A B
,%%B C
name%%D H
,%%H I
link%%J N
,%%N O
newNameLastDonwload%%P c
=%%d e
null%%f j
;%%j k
int&& 
countNovedades&& "
=&&# $
$num&&% &
;&&& '
HtmlWeb(( 
oWeb(( 
=(( 
new(( "
HtmlWeb((# *
(((* +
)((+ ,
;((, -
HtmlDocument)) 
doc))  
=))! "
oWeb))# '
.))' (
Load))( ,
()), -
Url))- 0
)))0 1
;))1 2
foreach++ 
(++ 
var++ 
Nodo++ !
in++" $
doc++% (
.++( )
DocumentNode++) 5
.++5 6
	CssSelect++6 ?
(++? @
$str++@ P
)++P Q
.++Q R
	CssSelect++R [
(++[ \
$str++\ m
)++m n
)++n o
{,, 
name.. 
=.. 
Nodo.. 
...  
	CssSelect..  )
(..) *
$str..* K
)..K L
...L M
	CssSelect..M V
(..V W
$str..W ]
)..] ^
...^ _
FirstOrDefault.._ m
(..m n
)..n o
...o p
	InnerText..p y
;..y z
link// 
=// 
Nodo// 
.//  
	CssSelect//  )
(//) *
$str//* >
)//> ?
.//? @
	CssSelect//@ I
(//I J
$str//J M
)//M N
.//N O
First//O T
(//T U
)//U V
.//V W

Attributes//W a
[//a b
$num//b c
]//c d
.//d e
Value//e j
;//j k
if00 
(00 
countNovedades00 &
==00' )
$num00* +
)00+ ,
newNameLastDonwload00- @
=00A B
name00C G
;00G H
if11 
(11 
!11 
string11 
.11  
IsNullOrEmpty11  -
(11- .
nameLastDonwload11. >
)11> ?
&&11@ B
nameLastDonwload11C S
.11S T
Equals11T Z
(11Z [
name11[ _
)11_ `
)11` a
break22 
;22 
else33 
news44 
.44 
Add44  
(44  !
new44! $
Comic44% *
(44* +
countNovedades44+ 9
,449 :
name44; ?
,44? @
link44A E
)44E F
)44F G
;44G H
if55 
(55 
string55 
.55 
IsNullOrEmpty55 ,
(55, -
nameLastDonwload55- =
)55= >
&&55? A
countNovedades55B P
==55Q S
$num55T U
)55U V
break66 
;66 
countNovedades77 "
++77" $
;77$ %
}88 
string:: 
path:: 
=::  
CreateFileReportNews:: 2
(::2 3
news::3 7
,::7 8
logger::9 ?
)::? @
;::@ A
if;; 
(;; 
!;; 
string;; 
.;; 
IsNullOrEmpty;; )
(;;) *
path;;* .
);;. /
);;/ 0
{<< "
CreateFileLastDownload== *
(==* +
newNameLastDonwload==+ >
,==> ?
logger==@ F
)==F G
;==G H
ReadFile>> 
(>> 
path>> !
,>>! "
logger>># )
)>>) *
;>>* +
}?? 
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 
ifDD 
(DD 
loggerDD 
!=DD 
nullDD "
)DD" #
loggerEE 
.EE 
ErrorEE  
(EE  !
stringEE! '
.EE' (
FormatEE( .
(EE. /
$strEE/ c
,EEc d

MethodBaseEEe o
.EEo p
GetCurrentMethod	EEp Ä
(
EEÄ Å
)
EEÅ Ç
.
EEÇ É
Name
EEÉ á
,
EEá à
ex
EEâ ã
.
EEã å
Message
EEå ì
)
EEì î
)
EEî ï
;
EEï ñ
}FF 
}GG 	
publicHH 
voidHH 
ReadFileHH 
(HH 
stringHH #
pathHH$ (
,HH( )
ILogHH* .
loggerHH/ 5
)HH5 6
{II 	
tryJJ 
{KK 
loggerLL 
.LL 
InfoLL 
(LL 
stringLL "
.LL" #
FormatLL# )
(LL) *
$strLL* F
,LLF G

MethodBaseLLH R
.LLR S
GetCurrentMethodLLS c
(LLc d
)LLd e
.LLe f
NameLLf j
)LLj k
)LLk l
;LLl m
usingMM 
(MM 
StreamReaderMM #

jsonStreamMM$ .
=MM/ 0
FileMM1 5
.MM5 6
OpenTextMM6 >
(MM> ?
pathMM? C
)MMC D
)MMD E
{NN 
stringOO 
lineOO 
;OO  
whilePP 
(PP 
(PP 
linePP  
=PP! "

jsonStreamPP# -
.PP- .
ReadLinePP. 6
(PP6 7
)PP7 8
)PP8 9
!=PP: <
nullPP= A
)PPA B
ProcessJSONQQ #
(QQ# $
(QQ$ %
JArrayQQ% +
)QQ+ ,
JsonConvertQQ, 7
.QQ7 8
DeserializeObjectQQ8 I
(QQI J
lineQQJ N
)QQN O
,QQO P
loggerQQQ W
)QQW X
;QQX Y
}RR 
loggerSS 
.SS 
InfoSS 
(SS 
stringSS "
.SS" #
FormatSS# )
(SS) *
$strSS* C
,SSC D

MethodBaseSSE O
.SSO P
GetCurrentMethodSSP `
(SS` a
)SSa b
.SSb c
NameSSc g
)SSg h
)SSh i
;SSi j
}TT 
catchUU 
(UU 
	ExceptionUU 
exUU 
)UU  
{VV 
ifWW 
(WW 
loggerWW 
!=WW 
nullWW "
)WW" #
loggerXX 
.XX 
ErrorXX  
(XX  !
stringXX! '
.XX' (
FormatXX( .
(XX. /
$strXX/ c
,XXc d

MethodBaseXXe o
.XXo p
GetCurrentMethod	XXp Ä
(
XXÄ Å
)
XXÅ Ç
.
XXÇ É
Name
XXÉ á
,
XXá à
ex
XXâ ã
.
XXã å
Message
XXå ì
)
XXì î
)
XXî ï
;
XXï ñ
}YY 
}ZZ 	
public[[ 
void[[ 
RenameFiles[[ 
([[  
string[[  &
path[[' +
,[[+ ,
ILog[[- 1
logger[[2 8
)[[8 9
{\\ 	
try]] 
{^^ 
logger__ 
.__ 
Info__ 
(__ 
string__ "
.__" #
Format__# )
(__) *
$str__* F
,__F G

MethodBase__H R
.__R S
GetCurrentMethod__S c
(__c d
)__d e
.__e f
Name__f j
)__j k
)__k l
;__l m
List`` 
<`` 
Comic`` 
>`` 
	listComic`` %
=``& '
new``( +
List``, 0
<``0 1
Comic``1 6
>``6 7
(``7 8
)``8 9
;``9 :
Listaa 
<aa 
Comicaa 
>aa 
listNoRenameaa (
=aa) *
newaa+ .
Listaa/ 3
<aa3 4
Comicaa4 9
>aa9 :
(aa: ;
)aa; <
;aa< =
usingbb 
(bb 
StreamReaderbb #

jsonStreambb$ .
=bb/ 0
Filebb1 5
.bb5 6
OpenTextbb6 >
(bb> ?
pathbb? C
)bbC D
)bbD E
{cc 
stringdd 
linedd 
;dd  
whileee 
(ee 
(ee 
lineee  
=ee! "

jsonStreamee# -
.ee- .
ReadLineee. 6
(ee6 7
)ee7 8
)ee8 9
!=ee: <
nullee= A
)eeA B
foreachff 
(ff  !
varff! $
xff% &
inff' )
(ff* +
JArrayff+ 1
)ff1 2
JsonConvertff2 =
.ff= >
DeserializeObjectff> O
(ffO P
lineffP T
)ffT U
)ffU V
	listComicgg %
.gg% &
Addgg& )
(gg) *
JsonConvertgg* 5
.gg5 6
DeserializeObjectgg6 G
<ggG H
ComicggH M
>ggM N
(ggN O
xggO P
.ggP Q
ToStringggQ Y
(ggY Z
)ggZ [
)gg[ \
)gg\ ]
;gg] ^
}hh 
foreachii 
(ii 
Comicii 
cii  
inii! #
	listComicii$ -
)ii- .
ifjj 
(jj 
!jj 

RenameFilejj #
(jj# $
cjj$ %
,jj% &
loggerjj' -
)jj- .
)jj. /
listNoRenamekk $
.kk$ %
Addkk% (
(kk( )
ckk) *
)kk* +
;kk+ ,$
CreateFileReportNoRenamell (
(ll( )
listNoRenamell) 5
,ll5 6
loggerll7 =
)ll= >
;ll> ?
loggermm 
.mm 
Infomm 
(mm 
stringmm "
.mm" #
Formatmm# )
(mm) *
$strmm* C
,mmC D

MethodBasemmE O
.mmO P
GetCurrentMethodmmP `
(mm` a
)mma b
.mmb c
Namemmc g
)mmg h
)mmh i
;mmi j
}nn 
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo  
{pp 
ifqq 
(qq 
loggerqq 
!=qq 
nullqq "
)qq" #
loggerrr 
.rr 
Errorrr  
(rr  !
stringrr! '
.rr' (
Formatrr( .
(rr. /
$strrr/ c
,rrc d

MethodBaserre o
.rro p
GetCurrentMethod	rrp Ä
(
rrÄ Å
)
rrÅ Ç
.
rrÇ É
Name
rrÉ á
,
rrá à
ex
rrâ ã
.
rrã å
Message
rrå ì
)
rrì î
)
rrî ï
;
rrï ñ
}ss 
}tt 	
publicuu 
voiduu 
ListCollectionsuu #
(uu# $
ILoguu$ (
loggeruu) /
,uu/ 0
stringuu1 7
optionuu8 >
=uu? @
$struuA G
)uuG H
{vv 	
tryww 
{xx 
loggeryy 
.yy 
Infoyy 
(yy 
stringyy "
.yy" #
Formatyy# )
(yy) *
$stryy* F
,yyF G

MethodBaseyyH R
.yyR S
GetCurrentMethodyyS c
(yyc d
)yyd e
.yye f
Nameyyf j
)yyj k
)yyk l
;yyl m
Listzz 
<zz 
stringzz 
>zz 
listCollectionszz ,
=zz- .
newzz/ 2
Listzz3 7
<zz7 8
stringzz8 >
>zz> ?
(zz? @
)zz@ A
;zzA B
HtmlWeb|| 
oWeb|| 
=|| 
new|| "
HtmlWeb||# *
(||* +
)||+ ,
;||, -
HtmlDocument}} 
doc}}  
=}}! "
oWeb}}# '
.}}' (
Load}}( ,
(}}, -
$str}}- U
)}}U V
;}}V W
if 
( 
option 
. 
Equals !
(! "
$str" (
)( )
)) *
{
ÄÄ 
foreach
ÅÅ 
(
ÅÅ 
var
ÅÅ  
Nodo
ÅÅ! %
in
ÅÅ& (
doc
ÅÅ) ,
.
ÅÅ, -
DocumentNode
ÅÅ- 9
.
ÅÅ9 :
	CssSelect
ÅÅ: C
(
ÅÅC D
$str
ÅÅD Q
)
ÅÅQ R
)
ÅÅR S
listCollections
ÇÇ '
.
ÇÇ' (
Add
ÇÇ( +
(
ÇÇ+ ,
Nodo
ÇÇ, 0
.
ÇÇ0 1

ChildNodes
ÇÇ1 ;
.
ÇÇ; <
Where
ÇÇ< A
(
ÇÇA B
x
ÇÇB C
=>
ÇÇD F
x
ÇÇG H
.
ÇÇH I
Name
ÇÇI M
.
ÇÇM N
Equals
ÇÇN T
(
ÇÇT U
$str
ÇÇU Y
)
ÇÇY Z
)
ÇÇZ [
.
ÇÇ[ \
Select
ÇÇ\ b
(
ÇÇb c
y
ÇÇc d
=>
ÇÇe g
y
ÇÇh i
.
ÇÇi j
NextSibling
ÇÇj u
)
ÇÇu v
.
ÇÇv w
Select
ÇÇw }
(
ÇÇ} ~
z
ÇÇ~ 
=>ÇÇÄ Ç
zÇÇÉ Ñ
.ÇÇÑ Ö
	InnerTextÇÇÖ é
.ÇÇé è
TrimÇÇè ì
(ÇÇì î
)ÇÇî ï
)ÇÇï ñ
.ÇÇñ ó
FirstOrDefaultÇÇó •
(ÇÇ• ¶
)ÇÇ¶ ß
)ÇÇß ®
;ÇÇ® ©)
CreateFileReportCollections
ÉÉ /
(
ÉÉ/ 0
listCollections
ÉÉ0 ?
,
ÉÉ? @
logger
ÉÉA G
)
ÉÉG H
;
ÉÉH I
}
ÑÑ 
if
ÜÜ 
(
ÜÜ 
option
ÜÜ 
.
ÜÜ 
Equals
ÜÜ !
(
ÜÜ! "
$str
ÜÜ" (
)
ÜÜ( )
)
ÜÜ) *
{
áá 
var
àà 
	listNodos
àà !
=
àà" #
doc
àà$ '
.
àà' (
DocumentNode
àà( 4
.
àà4 5
	CssSelect
àà5 >
(
àà> ?
$str
àà? L
)
ààL M
.
ààM N
	CssSelect
ààN W
(
ààW X
$str
ààX c
)
ààc d
.
ààd e
Select
ààe k
(
ààk l
n
ààl m
=>
ààn p
n
ààq r
.
ààr s

ChildNodes
ààs }
.
àà} ~
Whereàà~ É
(ààÉ Ñ
cnààÑ Ü
=>ààá â
cnààä å
.ààå ç
Nameààç ë
.ààë í
Equalsààí ò
(ààò ô
$strààô û
)ààû ü
)ààü †
)àà† °
.àà° ¢
Selectàà¢ ®
(àà® ©
nàà© ™
=>àà´ ≠
nààÆ Ø
.ààØ ∞
Selectàà∞ ∂
(àà∂ ∑
laàà∑ π
=>àà∫ º
laààΩ ø
.ààø ¿

Attributesàà¿  
.àà  À
WhereààÀ –
(àà– —
aàà— “
=>àà” ’
aàà÷ ◊
.àà◊ ÿ
Nameààÿ ‹
.àà‹ ›
Equalsàà› „
(àà„ ‰
$stràà‰ 
)àà Ò
)ààÒ Ú
)ààÚ Û
)ààÛ Ù
.ààÙ ı
ToListààı ˚
(àà˚ ¸
)àà¸ ˝
;àà˝ ˛
foreach
ââ 
(
ââ 
var
ââ  
Nodo
ââ! %
in
ââ& (
	listNodos
ââ) 2
)
ââ2 3
ReadCollection
ää &
(
ää& '
$str
ää' H
+
ääI J
Nodo
ääK O
.
ääO P
FirstOrDefault
ääP ^
(
ää^ _
)
ää_ `
.
ää` a
FirstOrDefault
ääa o
(
ääo p
)
ääp q
.
ääq r
Value
äär w
+
ääx y
$strääz Ç
,ääÇ É
loggerääÑ ä
)äää ã
;ääã å
}
ãã 
logger
çç 
.
çç 
Info
çç 
(
çç 
string
çç "
.
çç" #
Format
çç# )
(
çç) *
$str
çç* C
,
ççC D

MethodBase
ççE O
.
ççO P
GetCurrentMethod
ççP `
(
çç` a
)
çça b
.
ççb c
Name
ççc g
)
ççg h
)
ççh i
;
ççi j
}
éé 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
êê 
if
ëë 
(
ëë 
logger
ëë 
!=
ëë 
null
ëë "
)
ëë" #
logger
íí 
.
íí 
Error
íí  
(
íí  !
string
íí! '
.
íí' (
Format
íí( .
(
íí. /
$str
íí/ c
,
ííc d

MethodBase
ííe o
.
íío p
GetCurrentMethodííp Ä
(ííÄ Å
)ííÅ Ç
.ííÇ É
NameííÉ á
,ííá à
exííâ ã
.ííã å
Messageííå ì
)ííì î
)ííî ï
;ííï ñ
}
ìì 
}
îî 	
public
ïï 
void
ïï 
TreeDirectory
ïï !
(
ïï! "
DirectoryInfo
ïï" /
root
ïï0 4
,
ïï4 5
List
ïï6 :
<
ïï: ;
string
ïï; A
>
ïïA B
	listFiles
ïïC L
,
ïïL M
ILog
ïïN R
logger
ïïS Y
)
ïïY Z
{
ññ 	
FileInfo
óó 
[
óó 
]
óó 
files
óó 
=
óó 
null
óó #
;
óó# $
try
öö 
{
õõ 
files
úú 
=
úú 
root
úú 
.
úú 
GetFiles
úú %
(
úú% &
$str
úú& +
)
úú+ ,
;
úú, -
}
ùù 
catch
†† 
(
†† )
UnauthorizedAccessException
†† .
e
††/ 0
)
††0 1
{
°° 
logger
•• 
.
•• 
Warn
•• 
(
•• 
e
•• 
.
•• 
Message
•• %
)
••% &
;
••& '
}
¶¶ 
catch
®® 
(
®® (
DirectoryNotFoundException
®® -
e
®®. /
)
®®/ 0
{
©© 
Console
™™ 
.
™™ 
	WriteLine
™™ !
(
™™! "
e
™™" #
.
™™# $
Message
™™$ +
)
™™+ ,
;
™™, -
}
´´ 
if
≠≠ 
(
≠≠ 
files
≠≠ 
!=
≠≠ 
null
≠≠ 
)
≠≠ 
{
ÆÆ 
foreach
ØØ 
(
ØØ 
FileInfo
ØØ !
fi
ØØ" $
in
ØØ% '
files
ØØ( -
)
ØØ- .
{
∞∞ 
count
µµ 
++
µµ 
;
µµ 
Console
∂∂ 
.
∂∂ 
	WriteLine
∂∂ %
(
∂∂% &
fi
∂∂& (
.
∂∂( )
FullName
∂∂) 1
+
∂∂2 3
$str
∂∂4 7
+
∂∂8 9
count
∂∂: ?
)
∂∂? @
;
∂∂@ A
	listFiles
∑∑ 
.
∑∑ 
Add
∑∑ !
(
∑∑! "
fi
∑∑" $
.
∑∑$ %
Name
∑∑% )
.
∑∑) *
Replace
∑∑* 1
(
∑∑1 2
fi
∑∑2 4
.
∑∑4 5
	Extension
∑∑5 >
,
∑∑> ?
$str
∑∑@ B
)
∑∑B C
)
∑∑C D
;
∑∑D E
}
∏∏ 
DirectoryInfo
ºº 
[
ºº 
]
ºº 
subDirs
ºº  '
=
ºº( )
root
ºº* .
.
ºº. /
GetDirectories
ºº/ =
(
ºº= >
)
ºº> ?
;
ºº? @
foreach
ææ 
(
ææ 
DirectoryInfo
ææ &
dirInfo
ææ' .
in
ææ/ 1
subDirs
ææ2 9
)
ææ9 :
TreeDirectory
¿¿ !
(
¿¿! "
dirInfo
¿¿" )
,
¿¿) *
	listFiles
¿¿+ 4
,
¿¿4 5
logger
¿¿6 <
)
¿¿< =
;
¿¿= >
}
¡¡ 
}
¬¬ 	
public
√√ 
void
√√ 
ReadCollection
√√ "
(
√√" #
string
√√# )
url
√√* -
,
√√- .
ILog
√√/ 3
logger
√√4 :
)
√√: ;
{
ƒƒ 	
try
≈≈ 
{
∆∆ 
logger
«« 
.
«« 
Info
«« 
(
«« 
string
«« "
.
««" #
Format
««# )
(
««) *
$str
««* F
,
««F G

MethodBase
««H R
.
««R S
GetCurrentMethod
««S c
(
««c d
)
««d e
.
««e f
Name
««f j
)
««j k
)
««k l
;
««l m
List
»» 
<
»» 
Comic
»» 
>
»» 

collection
»» &
=
»»' (
new
»») ,
List
»»- 1
<
»»1 2
Comic
»»2 7
>
»»7 8
(
»»8 9
)
»»9 :
;
»»: ;
string
…… 
name
…… 
,
…… 
link
…… !
;
……! "
HtmlWeb
   
oWeb
   
=
   
new
   "
HtmlWeb
  # *
(
  * +
)
  + ,
;
  , -
HtmlDocument
ÀÀ 
doc
ÀÀ  
=
ÀÀ! "
oWeb
ÀÀ# '
.
ÀÀ' (
Load
ÀÀ( ,
(
ÀÀ, -
url
ÀÀ- 0
)
ÀÀ0 1
;
ÀÀ1 2
string
ÃÃ 
nameCollection
ÃÃ %
=
ÃÃ& '
doc
ÃÃ( +
.
ÃÃ+ ,
DocumentNode
ÃÃ, 8
.
ÃÃ8 9
	CssSelect
ÃÃ9 B
(
ÃÃB C
$str
ÃÃC K
)
ÃÃK L
.
ÃÃL M
Select
ÃÃM S
(
ÃÃS T
cn
ÃÃT V
=>
ÃÃW Y
cn
ÃÃZ \
.
ÃÃ\ ]

ChildNodes
ÃÃ] g
.
ÃÃg h
Where
ÃÃh m
(
ÃÃm n
n
ÃÃn o
=>
ÃÃp r
n
ÃÃs t
.
ÃÃt u
Name
ÃÃu y
==
ÃÃz |
$strÃÃ} Å
)ÃÃÅ Ç
)ÃÃÇ É
.ÃÃÉ Ñ
FirstOrDefaultÃÃÑ í
(ÃÃí ì
)ÃÃì î
.ÃÃî ï
SelectÃÃï õ
(ÃÃõ ú
nÃÃú ù
=>ÃÃû †
nÃÃ° ¢
.ÃÃ¢ £
	InnerTextÃÃ£ ¨
)ÃÃ¨ ≠
.ÃÃ≠ Æ
FirstOrDefaultÃÃÆ º
(ÃÃº Ω
)ÃÃΩ æ
.ÃÃæ ø
ReplaceÃÃø ∆
(ÃÃ∆ «
$strÃÃ« Ã
,ÃÃÃ Õ
stringÃÃŒ ‘
.ÃÃ‘ ’
EmptyÃÃ’ ⁄
)ÃÃ⁄ €
.ÃÃ€ ‹
	TrimStartÃÃ‹ Â
(ÃÃÂ Ê
)ÃÃÊ Á
.ÃÃÁ Ë
TrimÃÃË Ï
(ÃÃÏ Ì
)ÃÃÌ Ó
;ÃÃÓ Ô
int
ÕÕ 
count
ÕÕ 
=
ÕÕ 
doc
ÕÕ 
.
ÕÕ  
DocumentNode
ÕÕ  ,
.
ÕÕ, -
	CssSelect
ÕÕ- 6
(
ÕÕ6 7
$str
ÕÕ7 G
)
ÕÕG H
.
ÕÕH I
	CssSelect
ÕÕI R
(
ÕÕR S
$str
ÕÕS d
)
ÕÕd e
.
ÕÕe f
Count
ÕÕf k
(
ÕÕk l
)
ÕÕl m
;
ÕÕm n
foreach
ŒŒ 
(
ŒŒ 
var
ŒŒ 
Nodo
ŒŒ !
in
ŒŒ" $
doc
ŒŒ% (
.
ŒŒ( )
DocumentNode
ŒŒ) 5
.
ŒŒ5 6
	CssSelect
ŒŒ6 ?
(
ŒŒ? @
$str
ŒŒ@ P
)
ŒŒP Q
.
ŒŒQ R
	CssSelect
ŒŒR [
(
ŒŒ[ \
$str
ŒŒ\ m
)
ŒŒm n
)
ŒŒn o
{
œœ 
name
—— 
=
—— 
Nodo
—— 
.
——  
	CssSelect
——  )
(
——) *
$str
——* K
)
——K L
.
——L M
	CssSelect
——M V
(
——V W
$str
——W ]
)
——] ^
.
——^ _
FirstOrDefault
——_ m
(
——m n
)
——n o
.
——o p
	InnerText
——p y
;
——y z
link
““ 
=
““ 
Nodo
““ 
.
““  
	CssSelect
““  )
(
““) *
$str
““* >
)
““> ?
.
““? @
	CssSelect
““@ I
(
““I J
$str
““J M
)
““M N
.
““N O
First
““O T
(
““T U
)
““U V
.
““V W

Attributes
““W a
[
““a b
$num
““b c
]
““c d
.
““d e
Value
““e j
;
““j k

collection
”” 
.
”” 
Add
”” "
(
””" #
new
””# &
Comic
””' ,
(
””, -
count
””- 2
--
””2 4
,
””4 5
name
””6 :
,
””: ;
link
””< @
)
””@ A
)
””A B
;
””B C
}
‘‘ (
CreateFileReportCollection
’’ *
(
’’* +

collection
’’+ 5
.
’’5 6
OrderBy
’’6 =
(
’’= >
x
’’> ?
=>
’’@ B
x
’’C D
.
’’D E
Id
’’E G
)
’’G H
.
’’H I
ToList
’’I O
(
’’O P
)
’’P Q
,
’’Q R
nameCollection
’’S a
,
’’a b
logger
’’c i
)
’’i j
;
’’j k
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
logger
ŸŸ 
!=
ŸŸ 
null
ŸŸ "
)
ŸŸ" #
logger
⁄⁄ 
.
⁄⁄ 
Error
⁄⁄  
(
⁄⁄  !
string
⁄⁄! '
.
⁄⁄' (
Format
⁄⁄( .
(
⁄⁄. /
$str
⁄⁄/ c
,
⁄⁄c d

MethodBase
⁄⁄e o
.
⁄⁄o p
GetCurrentMethod⁄⁄p Ä
(⁄⁄Ä Å
)⁄⁄Å Ç
.⁄⁄Ç É
Name⁄⁄É á
,⁄⁄á à
ex⁄⁄â ã
.⁄⁄ã å
Message⁄⁄å ì
)⁄⁄ì î
)⁄⁄î ï
;⁄⁄ï ñ
}
€€ 
}
‹‹ 	
public
›› 
void
›› 
ReviewNoDownload
›› $
(
››$ %
string
››% +
fileName
››, 4
,
››4 5
ILog
››6 :
logger
››; A
)
››A B
{
ﬁﬁ 	
try
ﬂﬂ 
{
‡‡ 
logger
·· 
.
·· 
Info
·· 
(
·· 
string
·· "
.
··" #
Format
··# )
(
··) *
$str
··* F
,
··F G

MethodBase
··H R
.
··R S
GetCurrentMethod
··S c
(
··c d
)
··d e
.
··e f
Name
··f j
)
··j k
)
··k l
;
··l m
List
‚‚ 
<
‚‚ 
Comic
‚‚ 
>
‚‚ 
listComicsDia
‚‚ )
=
‚‚* +
new
‚‚, /
List
‚‚0 4
<
‚‚4 5
Comic
‚‚5 :
>
‚‚: ;
(
‚‚; <
)
‚‚< =
;
‚‚= >
List
„„ 
<
„„ 
Comic
„„ 
>
„„ 
listComicsDiaNo
„„ +
=
„„, -
new
„„. 1
List
„„2 6
<
„„6 7
Comic
„„7 <
>
„„< =
(
„„= >
)
„„> ?
;
„„? @
using
‰‰ 
(
‰‰ 
StreamReader
‰‰ #

jsonStream
‰‰$ .
=
‰‰/ 0
File
‰‰1 5
.
‰‰5 6
OpenText
‰‰6 >
(
‰‰> ?
fileName
‰‰? G
)
‰‰G H
)
‰‰H I
{
ÂÂ 
string
ÊÊ 
line
ÊÊ 
;
ÊÊ  
while
ÁÁ 
(
ÁÁ 
(
ÁÁ 
line
ÁÁ  
=
ÁÁ! "

jsonStream
ÁÁ# -
.
ÁÁ- .
ReadLine
ÁÁ. 6
(
ÁÁ6 7
)
ÁÁ7 8
)
ÁÁ8 9
!=
ÁÁ: <
null
ÁÁ= A
)
ÁÁA B
foreach
ËË 
(
ËË  !
var
ËË! $
json
ËË% )
in
ËË* ,
(
ËË- .
JArray
ËË. 4
)
ËË4 5
JsonConvert
ËË5 @
.
ËË@ A
DeserializeObject
ËËA R
(
ËËR S
line
ËËS W
)
ËËW X
)
ËËX Y
listComicsDia
ÈÈ )
.
ÈÈ) *
Add
ÈÈ* -
(
ÈÈ- .
JsonConvert
ÈÈ. 9
.
ÈÈ9 :
DeserializeObject
ÈÈ: K
<
ÈÈK L
Comic
ÈÈL Q
>
ÈÈQ R
(
ÈÈR S
json
ÈÈS W
.
ÈÈW X
ToString
ÈÈX `
(
ÈÈ` a
)
ÈÈa b
)
ÈÈb c
)
ÈÈc d
;
ÈÈd e
}
ÍÍ 
foreach
ÏÏ 
(
ÏÏ 
Comic
ÏÏ 
c
ÏÏ  
in
ÏÏ! #
listComicsDia
ÏÏ$ 1
)
ÏÏ1 2
{
ÌÌ 
bool
ÓÓ 
Cbr
ÓÓ 
=
ÓÓ 
new
ÓÓ "
FileInfo
ÓÓ# +
(
ÓÓ+ ,
string
ÓÓ- 3
.
ÓÓ3 4
Format
ÓÓ4 :
(
ÓÓ: ;
$strÓÓ< Ç
,ÓÓÇ É
cÓÓÑ Ö
.ÓÓÖ Ü
NameÓÓÜ ä
.ÓÓä ã
ReplaceÓÓã í
(ÓÓí ì
$strÓÓì ñ
,ÓÓñ ó
$strÓÓò õ
)ÓÓõ ú
)ÓÓú ù
)ÓÓù û
.ÓÓû ü
ExistsÓÓü •
;ÓÓ• ¶
bool
ÔÔ 
Cbz
ÔÔ 
=
ÔÔ 
new
ÔÔ "
FileInfo
ÔÔ# +
(
ÔÔ+ ,
string
ÔÔ, 2
.
ÔÔ2 3
Format
ÔÔ3 9
(
ÔÔ9 :
$strÔÔ: Ä
,ÔÔÄ Å
cÔÔÇ É
.ÔÔÉ Ñ
NameÔÔÑ à
.ÔÔà â
ReplaceÔÔâ ê
(ÔÔê ë
$strÔÔë î
,ÔÔî ï
$strÔÔñ ô
)ÔÔô ö
)ÔÔö õ
)ÔÔõ ú
.ÔÔú ù
ExistsÔÔù £
;ÔÔ£ §
if
 
(
 
!
 
Cbr
 
&&
 
!
  !
Cbz
! $
)
$ %
listComicsDiaNo
ÒÒ '
.
ÒÒ' (
Add
ÒÒ( +
(
ÒÒ+ ,
c
ÒÒ, -
)
ÒÒ- .
;
ÒÒ. /
}
ÚÚ (
CreateFileReportNoDownload
ÛÛ *
(
ÛÛ* +
listComicsDiaNo
ÛÛ+ :
,
ÛÛ: ;
logger
ÛÛ< B
)
ÛÛB C
;
ÛÛC D
}
ÙÙ 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
ˆˆ 
if
˜˜ 
(
˜˜ 
logger
˜˜ 
!=
˜˜ 
null
˜˜ "
)
˜˜" #
logger
¯¯ 
.
¯¯ 
Error
¯¯  
(
¯¯  !
string
¯¯! '
.
¯¯' (
Format
¯¯( .
(
¯¯. /
$str
¯¯/ c
,
¯¯c d

MethodBase
¯¯e o
.
¯¯o p
GetCurrentMethod¯¯p Ä
(¯¯Ä Å
)¯¯Å Ç
.¯¯Ç É
Name¯¯É á
,¯¯á à
ex¯¯â ã
.¯¯ã å
Message¯¯å ì
)¯¯ì î
)¯¯î ï
;¯¯ï ñ
}
˘˘ 
}
˙˙ 	
private
˛˛ 
void
˛˛ 
ProcessJSON
˛˛  
(
˛˛  !
JArray
˛˛! '
array
˛˛( -
,
˛˛- .
ILog
˛˛/ 3
logger
˛˛4 :
)
˛˛: ;
{
ˇˇ 	
try
ÄÄ 
{
ÅÅ 
List
ÇÇ 
<
ÇÇ 
Comic
ÇÇ 
>
ÇÇ "
collectionNoDownload
ÇÇ 0
=
ÇÇ1 2
new
ÇÇ3 6
List
ÇÇ7 ;
<
ÇÇ; <
Comic
ÇÇ< A
>
ÇÇA B
(
ÇÇB C
)
ÇÇC D
;
ÇÇD E
List
ÉÉ 
<
ÉÉ 
Comic
ÉÉ 
>
ÉÉ  
collectionNoRename
ÉÉ .
=
ÉÉ/ 0
new
ÉÉ1 4
List
ÉÉ5 9
<
ÉÉ9 :
Comic
ÉÉ: ?
>
ÉÉ? @
(
ÉÉ@ A
)
ÉÉA B
;
ÉÉB C
int
ÑÑ 
cont
ÑÑ 
=
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
bool
ÑÑ "
result
ÑÑ# )
=
ÑÑ* +
false
ÑÑ, 1
;
ÑÑ1 2
foreach
ÖÖ 
(
ÖÖ 
JObject
ÖÖ  
c
ÖÖ! "
in
ÖÖ# %
array
ÖÖ& +
.
ÖÖ+ ,
OfType
ÖÖ, 2
<
ÖÖ2 3
JObject
ÖÖ3 :
>
ÖÖ: ;
(
ÖÖ; <
)
ÖÖ< =
)
ÖÖ= >
{
ÜÜ 
Comic
àà 
comic
àà 
=
àà  !
new
àà" %
Comic
àà& +
(
àà+ ,
cont
àà, 0
++
àà0 2
,
àà2 3
c
àà4 5
.
àà5 6
GetValue
àà6 >
(
àà> ?
$str
àà? E
)
ààE F
.
ààF G
ToString
ààG O
(
ààO P
)
ààP Q
.
ààQ R
Replace
ààR Y
(
ààY Z
$str
ààZ ]
,
àà] ^
$str
àà_ b
)
ààb c
,
ààc d
c
ààe f
.
ààf g
GetValue
ààg o
(
àào p
$str
ààp v
)
ààv w
.
ààw x
ToStringààx Ä
(ààÄ Å
)ààÅ Ç
)ààÇ É
;ààÉ Ñ
Console
ââ 
.
ââ 
	WriteLine
ââ %
(
ââ% &
comic
ââ& +
.
ââ+ ,
Name
ââ, 0
)
ââ0 1
;
ââ1 2
logger
ââ3 9
.
ââ9 :
Warn
ââ: >
(
ââ> ?
string
ââ? E
.
ââE F
Format
ââF L
(
ââL M
$str
ââM Z
,
ââZ [
comic
ââ\ a
.
ââa b
ToString
ââb j
(
ââj k
)
ââk l
)
ââl m
)
ââm n
;
âân o
if
åå 
(
åå 
comic
åå 
.
åå 
Link
åå "
.
åå" #
Contains
åå# +
(
åå+ ,
$str
åå, 5
)
åå5 6
)
åå6 7
result
çç 
=
çç  !
ProcessDownloadMega
çç! 4
(
çç4 5
comic
çç5 :
,
çç: ;
logger
çç< B
)
ççB C
;
ççC D
else
éé 
if
éé 
(
éé 
comic
éé "
.
éé" #
Link
éé# '
.
éé' (
Contains
éé( 0
(
éé0 1
$str
éé1 @
)
éé@ A
)
ééA B
result
èè 
=
èè  &
ProcessDownloadMediaFire
èè! 9
(
èè9 :
comic
èè: ?
,
èè? @
logger
èèA G
)
èèG H
;
èèH I
else
êê 
result
ëë 
=
ëë  
false
ëë! &
;
ëë& '
if
îî 
(
îî 
result
îî 
)
îî 
{
ïï 
if
ññ 
(
ññ 
!
ññ 

RenameFile
ññ '
(
ññ' (
comic
ññ( -
,
ññ- .
logger
ññ/ 5
)
ññ5 6
)
ññ6 7 
collectionNoRename
óó .
.
óó. /
Add
óó/ 2
(
óó2 3
comic
óó3 8
)
óó8 9
;
óó9 :
}
òò 
else
ôô "
collectionNoDownload
öö ,
.
öö, -
Add
öö- 0
(
öö0 1
comic
öö1 6
)
öö6 7
;
öö7 8
logger
õõ 
.
õõ 
Debug
õõ  
(
õõ  !
string
õõ! '
.
õõ' (
Format
õõ( .
(
õõ. /
$str
õõ/ :
,
õõ: ;
Comic
õõ< A
.
õõA B

Serializer
õõB L
(
õõL M
new
õõM P
List
õõQ U
<
õõU V
Comic
õõV [
>
õõ[ \
{
õõ] ^
comic
õõ_ d
}
õõe f
,
õõf g
false
õõh m
)
õõm n
)
õõn o
)
õõo p
;
õõp q
logger
úú 
.
úú 
Warn
úú 
(
úú  
string
úú  &
.
úú& '
Format
úú' -
(
úú- .
$str
úú. 8
,
úú8 9
comic
úú: ?
.
úú? @
ToString
úú@ H
(
úúH I
)
úúI J
)
úúJ K
)
úúK L
;
úúL M
}
ùù 
if
ûû 
(
ûû "
collectionNoDownload
ûû (
.
ûû( )
Count
ûû) .
>
ûû/ 0
$num
ûû1 2
)
ûû2 3(
CreateFileReportNoDownload
üü .
(
üü. /"
collectionNoDownload
üü/ C
,
üüC D
logger
üüE K
)
üüK L
;
üüL M
if
†† 
(
††  
collectionNoRename
†† &
.
††& '
Count
††' ,
>
††- .
$num
††/ 0
)
††0 1&
CreateFileReportNoRename
°° ,
(
°°, -"
collectionNoDownload
°°- A
,
°°A B
logger
°°C I
)
°°I J
;
°°J K
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
§§ 
if
•• 
(
•• 
logger
•• 
!=
•• 
null
•• "
)
••" #
logger
¶¶ 
.
¶¶ 
Error
¶¶  
(
¶¶  !
string
¶¶! '
.
¶¶' (
Format
¶¶( .
(
¶¶. /
$str
¶¶/ c
,
¶¶c d

MethodBase
¶¶e o
.
¶¶o p
GetCurrentMethod¶¶p Ä
(¶¶Ä Å
)¶¶Å Ç
.¶¶Ç É
Name¶¶É á
,¶¶á à
ex¶¶â ã
.¶¶ã å
Message¶¶å ì
)¶¶ì î
)¶¶î ï
;¶¶ï ñ
}
ßß 
}
®® 	
private
¨¨ 
bool
¨¨ !
ProcessDownloadMega
¨¨ (
(
¨¨( )
Comic
¨¨) .
comic
¨¨/ 4
,
¨¨4 5
ILog
¨¨6 :
logger
¨¨; A
)
¨¨A B
{
≠≠ 	
try
ÆÆ 
{
ØØ 
Uri
≤≤ 
uri
≤≤ 
=
≤≤ 
new
≤≤ 
Uri
≤≤ !
(
≤≤! "
comic
≤≤" '
.
≤≤' (
Link
≤≤( ,
)
≤≤, -
;
≤≤- .
	INodeInfo
≥≥ 
infoMega
≥≥ "
=
≥≥# $
ApiMega
≥≥% ,
.
≥≥, -
GetNodeFromLink
≥≥- <
(
≥≥< =
uri
≥≥= @
)
≥≥@ A
;
≥≥A B
ApiMega
¥¥ 
.
¥¥ 
DownloadFile
¥¥ $
(
¥¥$ %
uri
¥¥% (
,
¥¥( )
Environment
¥¥* 5
.
¥¥5 6
CurrentDirectory
¥¥6 F
+
¥¥G H
$str
¥¥I V
+
¥¥W X
infoMega
¥¥Y a
.
¥¥a b
Name
¥¥b f
)
¥¥f g
;
¥¥g h
comic
µµ 
.
µµ 
NameWeb
µµ 
=
µµ 
infoMega
µµ  (
.
µµ( )
Name
µµ) -
;
µµ- .
comic
∂∂ 
.
∂∂ 
SizeWeb
∂∂ 
=
∂∂ 

FormatSize
∂∂  *
(
∂∂* +
infoMega
∂∂+ 3
.
∂∂3 4
Size
∂∂4 8
)
∂∂8 9
;
∂∂9 :
return
∏∏ 
true
∏∏ 
;
∏∏ 
}
ππ 
catch
∫∫ 
(
∫∫ 
	Exception
∫∫ 
ex
∫∫ 
)
∫∫  
{
ªª 
if
ºº 
(
ºº 
logger
ºº 
!=
ºº 
null
ºº "
)
ºº" #
logger
ΩΩ 
.
ΩΩ 
Error
ΩΩ  
(
ΩΩ  !
string
ΩΩ! '
.
ΩΩ' (
Format
ΩΩ( .
(
ΩΩ. /
$str
ΩΩ/ c
,
ΩΩc d

MethodBase
ΩΩe o
.
ΩΩo p
GetCurrentMethodΩΩp Ä
(ΩΩÄ Å
)ΩΩÅ Ç
.ΩΩÇ É
NameΩΩÉ á
,ΩΩá à
exΩΩâ ã
.ΩΩã å
MessageΩΩå ì
)ΩΩì î
)ΩΩî ï
;ΩΩï ñ
return
ææ 
false
ææ 
;
ææ 
}
øø 
}
¿¿ 	
private
¡¡ 
bool
¡¡ &
ProcessDownloadMediaFire
¡¡ -
(
¡¡- .
Comic
¡¡. 3
comic
¡¡4 9
,
¡¡9 :
ILog
¡¡; ?
logger
¡¡@ F
)
¡¡F G
{
¬¬ 	
try
√√ 
{
ƒƒ 
HtmlWeb
≈≈ 
oWeb
≈≈ 
=
≈≈ 
new
≈≈ "
HtmlWeb
≈≈# *
(
≈≈* +
)
≈≈+ ,
;
≈≈, -
HtmlDocument
∆∆ 
doc
∆∆  
=
∆∆! "
oWeb
∆∆# '
.
∆∆' (
Load
∆∆( ,
(
∆∆, -
comic
∆∆- 2
.
∆∆2 3
Link
∆∆3 7
)
∆∆7 8
;
∆∆8 9
comic
«« 
.
«« 
NameWeb
«« 
=
«« 
doc
««  #
.
««# $
DocumentNode
««$ 0
.
««0 1
	CssSelect
««1 :
(
««: ;
$str
««; E
)
««E F
.
««F G
	CssSelect
««G P
(
««P Q
$str
««Q \
)
««\ ]
.
««] ^
ToList
««^ d
(
««d e
)
««e f
[
««f g
$num
««g h
]
««h i
.
««i j
	InnerText
««j s
;
««s t
string
»» 
linkDownload
»» #
=
»»$ %
doc
»»& )
.
»») *
DocumentNode
»»* 6
.
»»6 7
	CssSelect
»»7 @
(
»»@ A
$str
»»A Q
)
»»Q R
.
»»R S
	CssSelect
»»S \
(
»»\ ]
$str
»»] e
)
»»e f
.
»»f g
First
»»g l
(
»»l m
)
»»m n
.
»»n o

Attributes
»»o y
[
»»y z
$num
»»z {
]
»»{ |
.
»»| }
Value»»} Ç
;»»Ç É
string
ÀÀ 
size
ÀÀ 
=
ÀÀ 
doc
ÀÀ !
.
ÀÀ! "
DocumentNode
ÀÀ" .
.
ÀÀ. /
	CssSelect
ÀÀ/ 8
(
ÀÀ8 9
$str
ÀÀ9 C
)
ÀÀC D
.
ÀÀD E
	CssSelect
ÀÀE N
(
ÀÀN O
$str
ÀÀO Y
)
ÀÀY Z
.
ÀÀZ [
ToList
ÀÀ[ a
(
ÀÀa b
)
ÀÀb c
[
ÀÀc d
$num
ÀÀd e
]
ÀÀe f
.
ÀÀf g
	InnerText
ÀÀg p
;
ÀÀp q
size
ÃÃ 
=
ÃÃ 
size
ÃÃ 
.
ÃÃ 
Replace
ÃÃ #
(
ÃÃ# $
$str
ÃÃ$ 1
,
ÃÃ1 2
$str
ÃÃ3 6
)
ÃÃ6 7
.
ÃÃ7 8
Replace
ÃÃ8 ?
(
ÃÃ? @
$str
ÃÃ@ D
,
ÃÃD E
$str
ÃÃF I
)
ÃÃI J
;
ÃÃJ K
int
ÕÕ 
dif
ÕÕ 
=
ÕÕ 
size
ÕÕ 
.
ÕÕ 
LastIndexOf
ÕÕ *
(
ÕÕ* +
$str
ÕÕ+ .
)
ÕÕ. /
-
ÕÕ0 1
size
ÕÕ2 6
.
ÕÕ6 7
IndexOf
ÕÕ7 >
(
ÕÕ> ?
$str
ÕÕ? B
)
ÕÕB C
-
ÕÕD E
$num
ÕÕF G
;
ÕÕG H
comic
ŒŒ 
.
ŒŒ 
SizeWeb
ŒŒ 
=
ŒŒ 
size
ŒŒ  $
.
ŒŒ$ %
	Substring
ŒŒ% .
(
ŒŒ. /
size
ŒŒ/ 3
.
ŒŒ3 4
IndexOf
ŒŒ4 ;
(
ŒŒ; <
$str
ŒŒ< ?
)
ŒŒ? @
+
ŒŒA B
$num
ŒŒC D
,
ŒŒD E
dif
ŒŒF I
)
ŒŒI J
;
ŒŒJ K
System
œœ 
.
œœ 
Net
œœ 
.
œœ 
	WebClient
œœ $
wc
œœ% '
=
œœ( )
new
œœ* -
System
œœ. 4
.
œœ4 5
Net
œœ5 8
.
œœ8 9
	WebClient
œœ9 B
(
œœB C
)
œœC D
;
œœD E
wc
–– 
.
–– 
DownloadFile
–– 
(
––  
linkDownload
––  ,
,
––, -
Environment
––. 9
.
––9 :
CurrentDirectory
––: J
+
––K L
$str
––M Z
+
––[ \
comic
––] b
.
––b c
NameWeb
––c j
)
––j k
;
––k l
wc
—— 
.
—— 
Dispose
—— 
(
—— 
)
—— 
;
—— 
return
““ 
true
““ 
;
““ 
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
if
÷÷ 
(
÷÷ 
logger
÷÷ 
!=
÷÷ 
null
÷÷ "
)
÷÷" #
logger
◊◊ 
.
◊◊ 
Error
◊◊  
(
◊◊  !
string
◊◊! '
.
◊◊' (
Format
◊◊( .
(
◊◊. /
$str
◊◊/ c
,
◊◊c d

MethodBase
◊◊e o
.
◊◊o p
GetCurrentMethod◊◊p Ä
(◊◊Ä Å
)◊◊Å Ç
.◊◊Ç É
Name◊◊É á
,◊◊á à
ex◊◊â ã
.◊◊ã å
Message◊◊å ì
)◊◊ì î
)◊◊î ï
;◊◊ï ñ
return
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
ŸŸ 
}
⁄⁄ 	
public
ﬁﬁ 
bool
ﬁﬁ &
CheckDirectoriesAndFiles
ﬁﬁ ,
(
ﬁﬁ, -
ILog
ﬁﬁ- 1
logger
ﬁﬁ2 8
)
ﬁﬁ8 9
{
ﬂﬂ 	
try
‡‡ 
{
·· 
if
‚‚ 
(
‚‚ 
!
‚‚ 
new
‚‚ 
DirectoryInfo
‚‚ &
(
‚‚& '
Environment
‚‚' 2
.
‚‚2 3
CurrentDirectory
‚‚3 C
+
‚‚D E
$str
‚‚F N
)
‚‚N O
.
‚‚O P
Exists
‚‚P V
)
‚‚V W
	Directory
„„ 
.
„„ 
CreateDirectory
„„ -
(
„„- .
Environment
„„. 9
.
„„9 :
CurrentDirectory
„„: J
+
„„K L
$str
„„M U
)
„„U V
;
„„V W
if
‰‰ 
(
‰‰ 
!
‰‰ 
new
‰‰ 
DirectoryInfo
‰‰ &
(
‰‰& '
Environment
‰‰' 2
.
‰‰2 3
CurrentDirectory
‰‰3 C
+
‰‰D E
$str
‰‰F S
)
‰‰S T
.
‰‰T U
Exists
‰‰U [
)
‰‰[ \
	Directory
ÂÂ 
.
ÂÂ 
CreateDirectory
ÂÂ -
(
ÂÂ- .
Environment
ÂÂ. 9
.
ÂÂ9 :
CurrentDirectory
ÂÂ: J
+
ÂÂK L
$str
ÂÂM Z
)
ÂÂZ [
;
ÂÂ[ \
if
ÊÊ 
(
ÊÊ 
!
ÊÊ 
new
ÊÊ 
DirectoryInfo
ÊÊ &
(
ÊÊ& '
Environment
ÊÊ' 2
.
ÊÊ2 3
CurrentDirectory
ÊÊ3 C
+
ÊÊD E
$str
ÊÊF Q
)
ÊÊQ R
.
ÊÊR S
Exists
ÊÊS Y
)
ÊÊY Z
	Directory
ÁÁ 
.
ÁÁ 
CreateDirectory
ÁÁ -
(
ÁÁ- .
Environment
ÁÁ. 9
.
ÁÁ9 :
CurrentDirectory
ÁÁ: J
+
ÁÁK L
$str
ÁÁM X
)
ÁÁX Y
;
ÁÁY Z
return
ËË 
true
ËË 
;
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
if
ÏÏ 
(
ÏÏ 
logger
ÏÏ 
!=
ÏÏ 
null
ÏÏ "
)
ÏÏ" #
logger
ÌÌ 
.
ÌÌ 
Error
ÌÌ  
(
ÌÌ  !
string
ÌÌ! '
.
ÌÌ' (
Format
ÌÌ( .
(
ÌÌ. /
$str
ÌÌ/ c
,
ÌÌc d

MethodBase
ÌÌe o
.
ÌÌo p
GetCurrentMethodÌÌp Ä
(ÌÌÄ Å
)ÌÌÅ Ç
.ÌÌÇ É
NameÌÌÉ á
,ÌÌá à
exÌÌâ ã
.ÌÌã å
MessageÌÌå ì
)ÌÌì î
)ÌÌî ï
;ÌÌï ñ
return
ÓÓ 
false
ÓÓ 
;
ÓÓ 
}
ÔÔ 
}
 	
private
ÒÒ 
bool
ÒÒ 

RenameFile
ÒÒ 
(
ÒÒ  
Comic
ÒÒ  %
comic
ÒÒ& +
,
ÒÒ+ ,
ILog
ÒÒ- 1
logger
ÒÒ2 8
)
ÒÒ8 9
{
ÚÚ 	
try
ÛÛ 
{
ÙÙ 
bool
ıı 
result
ıı 
=
ıı 
true
ıı "
;
ıı" #
string
ˆˆ 
destinyPath
ˆˆ "
=
ˆˆ# $
Environment
ˆˆ% 0
.
ˆˆ0 1
CurrentDirectory
ˆˆ1 A
+
ˆˆB C
$str
ˆˆD Q
+
ˆˆR S
comic
ˆˆT Y
.
ˆˆY Z
Name
ˆˆZ ^
;
ˆˆ^ _
FileInfo
˜˜ 
fileDownloadInfo
˜˜ )
=
˜˜* +
new
˜˜, /
FileInfo
˜˜0 8
(
˜˜8 9
Environment
˜˜9 D
.
˜˜D E
CurrentDirectory
˜˜E U
+
˜˜V W
$str
˜˜X e
+
˜˜f g
comic
˜˜h m
.
˜˜m n
NameWeb
˜˜n u
)
˜˜u v
;
˜˜v w
if
¯¯ 
(
¯¯ 
destinyPath
¯¯ 
.
¯¯  
Equals
¯¯  &
(
¯¯& '
fileDownloadInfo
¯¯' 7
.
¯¯7 8
FullName
¯¯8 @
)
¯¯@ A
)
¯¯A B
return
˘˘ 
true
˘˘ 
;
˘˘  
if
˙˙ 
(
˙˙ 
fileDownloadInfo
˙˙ $
.
˙˙$ %
Exists
˙˙% +
)
˙˙+ ,
{
˚˚ 
string
¸¸ 
sizeWeb
¸¸ "
=
¸¸# $
string
¸¸% +
.
¸¸+ ,
Format
¸¸, 2
(
¸¸2 3
$str
¸¸3 ;
,
¸¸; <
float
¸¸= B
.
¸¸B C
Parse
¸¸C H
(
¸¸H I
comic
¸¸I N
.
¸¸N O
SizeWeb
¸¸O V
.
¸¸V W
Replace
¸¸W ^
(
¸¸^ _
$str
¸¸_ b
,
¸¸b c
$str
¸¸d g
)
¸¸g h
)
¸¸h i
)
¸¸i j
;
¸¸j k
string
˝˝ 
sizeDisk
˝˝ #
=
˝˝$ %
string
˝˝& ,
.
˝˝, -
Format
˝˝- 3
(
˝˝3 4
$str
˝˝4 <
,
˝˝< =
float
˝˝> C
.
˝˝C D
Parse
˝˝D I
(
˝˝I J

FormatSize
˝˝J T
(
˝˝T U
fileDownloadInfo
˝˝U e
.
˝˝e f
Length
˝˝f l
)
˝˝l m
)
˝˝m n
)
˝˝n o
;
˝˝o p
if
˛˛ 
(
˛˛ 
sizeWeb
˛˛ 
.
˛˛  
Equals
˛˛  &
(
˛˛& '
sizeDisk
˛˛' /
)
˛˛/ 0
)
˛˛0 1
{
ˇˇ 
if
ÄÄ 
(
ÄÄ 
fileDownloadInfo
ÄÄ ,
.
ÄÄ, -
	Extension
ÄÄ- 6
.
ÄÄ6 7
Equals
ÄÄ7 =
(
ÄÄ= >
$str
ÄÄ> D
)
ÄÄD E
)
ÄÄE F
File
ÅÅ  
.
ÅÅ  !
Move
ÅÅ! %
(
ÅÅ% &
fileDownloadInfo
ÅÅ& 6
.
ÅÅ6 7
FullName
ÅÅ7 ?
,
ÅÅ? @
destinyPath
ÅÅA L
+
ÅÅM N
$str
ÅÅO U
)
ÅÅU V
;
ÅÅV W
else
ÇÇ 
if
ÇÇ 
(
ÇÇ  !
fileDownloadInfo
ÇÇ! 1
.
ÇÇ1 2
	Extension
ÇÇ2 ;
.
ÇÇ; <
Equals
ÇÇ< B
(
ÇÇB C
$str
ÇÇC I
)
ÇÇI J
)
ÇÇJ K
File
ÉÉ  
.
ÉÉ  !
Move
ÉÉ! %
(
ÉÉ% &
fileDownloadInfo
ÉÉ& 6
.
ÉÉ6 7
FullName
ÉÉ7 ?
,
ÉÉ? @
destinyPath
ÉÉA L
+
ÉÉM N
$str
ÉÉO U
)
ÉÉU V
;
ÉÉV W
else
ÑÑ 
if
ÑÑ 
(
ÑÑ  !
fileDownloadInfo
ÑÑ! 1
.
ÑÑ1 2
	Extension
ÑÑ2 ;
.
ÑÑ; <
Equals
ÑÑ< B
(
ÑÑB C
$str
ÑÑC I
)
ÑÑI J
||
ÑÑK M
fileDownloadInfo
ÑÑN ^
.
ÑÑ^ _
	Extension
ÑÑ_ h
.
ÑÑh i
Equals
ÑÑi o
(
ÑÑo p
$str
ÑÑp v
)
ÑÑv w
)
ÑÑw x
result
ÖÖ "
=
ÖÖ# $
ExtractFile
ÖÖ% 0
(
ÖÖ0 1
fileDownloadInfo
ÖÖ1 A
,
ÖÖA B
destinyPath
ÖÖC N
,
ÖÖN O
logger
ÖÖP V
)
ÖÖV W
;
ÖÖW X
else
ÜÜ 
File
áá  
.
áá  !
Move
áá! %
(
áá% &
fileDownloadInfo
áá& 6
.
áá6 7
FullName
áá7 ?
,
áá? @
destinyPath
ááA L
+
ááM N
$str
ááO U
)
ááU V
;
ááV W
if
àà 
(
àà 
result
àà "
)
àà" #
File
ââ  
.
ââ  !
Delete
ââ! '
(
ââ' (
fileDownloadInfo
ââ( 8
.
ââ8 9
FullName
ââ9 A
)
ââA B
;
ââB C
}
ää 
}
ãã 
else
åå 
return
çç 
false
çç  
;
çç  !
return
éé 
result
éé 
;
éé 
}
èè 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
if
íí 
(
íí 
logger
íí 
!=
íí 
null
íí "
)
íí" #
logger
ìì 
.
ìì 
Error
ìì  
(
ìì  !
string
ìì! '
.
ìì' (
Format
ìì( .
(
ìì. /
$str
ìì/ c
,
ììc d

MethodBase
ììe o
.
ììo p
GetCurrentMethodììp Ä
(ììÄ Å
)ììÅ Ç
.ììÇ É
NameììÉ á
,ììá à
exììâ ã
.ììã å
Messageììå ì
)ììì î
)ììî ï
;ììï ñ
return
îî 
false
îî 
;
îî 
}
ïï 
}
ññ 	
private
óó 
bool
óó 
ExtractFile
óó  
(
óó  !
FileInfo
óó! )
fileDownloadInfo
óó* :
,
óó: ;
string
óó< B
destinyPath
óóC N
,
óóN O
ILog
óóP T
logger
óóU [
)
óó[ \
{
òò 	
try
ôô 
{
öö 
if
úú 
(
úú 
fileDownloadInfo
úú $
.
úú$ %
	Extension
úú% .
.
úú. /
Equals
úú/ 5
(
úú5 6
$str
úú6 <
)
úú< =
)
úú= >
{
ùù 
using
ûû 
ArchiveFile
ûû %
archiveFile
ûû& 1
=
ûû2 3
new
ûû4 7
ArchiveFile
ûû8 C
(
ûûC D
fileDownloadInfo
ûûD T
.
ûûT U
FullName
ûûU ]
)
ûû] ^
;
ûû^ _
archiveFile
üü 
.
üü  
Extract
üü  '
(
üü' (
Environment
üü( 3
.
üü3 4
CurrentDirectory
üü4 D
+
üüE F
$str
üüG Z
)
üüZ [
;
üü[ \
}
†† 
else
°° 
ZipFile
¢¢ 
.
¢¢  
ExtractToDirectory
¢¢ .
(
¢¢. /
fileDownloadInfo
¢¢/ ?
.
¢¢? @
FullName
¢¢@ H
,
¢¢H I
Environment
¢¢J U
.
¢¢U V
CurrentDirectory
¢¢V f
+
¢¢g h
$str
¢¢i |
)
¢¢| }
;
¢¢} ~
int
•• 

countFiles
•• 
=
••  
new
••! $
DirectoryInfo
••% 2
(
••2 3
Environment
••3 >
.
••> ?
CurrentDirectory
••? O
+
••P Q
$str
••R e
)
••e f
.
••f g
GetFiles
••g o
(
••o p
)
••p q
.
••q r
Count
••r w
(
••w x
)
••x y
;
••y z
if
¶¶ 
(
¶¶ 

countFiles
¶¶ 
==
¶¶ !
$num
¶¶" #
)
¶¶# $
{
ßß 
DirectoryInfo
®® !
directoryDescom
®®" 1
=
®®2 3
new
®®4 7
DirectoryInfo
®®8 E
(
®®E F
Environment
®®F Q
.
®®Q R
CurrentDirectory
®®R b
+
®®c d
$str
®®e x
)
®®x y
.
®®y z
GetDirectories®®z à
(®®à â
)®®â ä
.®®ä ã!
OrderByDescending®®ã ú
(®®ú ù
d®®ù û
=>®®ü °
d®®¢ £
.®®£ §
CreationTime®®§ ∞
)®®∞ ±
.®®± ≤
First®®≤ ∑
(®®∑ ∏
)®®∏ π
;®®π ∫
long
©© 
diffTimeDir
©© $
=
©©% &
DateAndTime
©©' 2
.
©©2 3
DateDiff
©©3 ;
(
©©; <
DateInterval
©©< H
.
©©H I
Second
©©I O
,
©©O P
directoryDescom
©©Q `
.
©©` a
CreationTime
©©a m
,
©©m n
DateTime
©©o w
.
©©w x
Now
©©x {
)
©©{ |
;
©©| }
if
™™ 
(
™™ 
diffTimeDir
™™ #
<=
™™$ &
$num
™™' )
)
™™) *
{
´´ 
ZipFile
¨¨ 
.
¨¨  !
CreateFromDirectory
¨¨  3
(
¨¨3 4
directoryDescom
¨¨4 C
.
¨¨C D
FullName
¨¨D L
,
¨¨L M
destinyPath
¨¨N Y
+
¨¨Z [
$str
¨¨\ b
)
¨¨b c
;
¨¨c d
	Directory
≠≠ !
.
≠≠! "
Delete
≠≠" (
(
≠≠( )
directoryDescom
≠≠) 8
.
≠≠8 9
FullName
≠≠9 A
,
≠≠A B
true
≠≠C G
)
≠≠G H
;
≠≠H I
}
ÆÆ 
}
ØØ 
if
±± 
(
±± 

countFiles
±± 
==
±± !
$num
±±" #
)
±±# $
{
≤≤ 
FileInfo
≥≥ 

fileDescom
≥≥ '
=
≥≥( )
new
≥≥* -
DirectoryInfo
≥≥. ;
(
≥≥; <
Environment
≥≥< G
.
≥≥G H
CurrentDirectory
≥≥H X
+
≥≥Y Z
$str
≥≥[ n
)
≥≥n o
.
≥≥o p
GetFiles
≥≥p x
(
≥≥x y
)
≥≥y z
.
≥≥z { 
OrderByDescending≥≥{ å
(≥≥å ç
f≥≥ç é
=>≥≥è ë
f≥≥í ì
.≥≥ì î
CreationTime≥≥î †
)≥≥† °
.≥≥° ¢
First≥≥¢ ß
(≥≥ß ®
)≥≥® ©
;≥≥© ™
long
¥¥ 
diffTimeFile
¥¥ %
=
¥¥& '
DateAndTime
¥¥( 3
.
¥¥3 4
DateDiff
¥¥4 <
(
¥¥< =
DateInterval
¥¥= I
.
¥¥I J
Second
¥¥J P
,
¥¥P Q

fileDescom
¥¥R \
.
¥¥\ ]
CreationTime
¥¥] i
,
¥¥i j
DateTime
¥¥k s
.
¥¥s t
Now
¥¥t w
)
¥¥w x
;
¥¥x y
if
µµ 
(
µµ 
diffTimeFile
µµ $
<=
µµ% '
$num
µµ( *
&&
µµ+ -
!
µµ. /

fileDescom
µµ/ 9
.
µµ9 :
FullName
µµ: B
.
µµB C
Equals
µµC I
(
µµI J
fileDownloadInfo
µµJ Z
.
µµZ [
FullName
µµ[ c
)
µµc d
)
µµd e
{
∂∂ 
File
∑∑ 
.
∑∑ 
Move
∑∑ !
(
∑∑! "

fileDescom
∑∑" ,
.
∑∑, -
FullName
∑∑- 5
,
∑∑5 6
destinyPath
∑∑7 B
+
∑∑C D

fileDescom
∑∑E O
.
∑∑O P
	Extension
∑∑P Y
)
∑∑Y Z
;
∑∑Z [
File
∏∏ 
.
∏∏ 
Delete
∏∏ #
(
∏∏# $

fileDescom
∏∏$ .
.
∏∏. /
FullName
∏∏/ 7
)
∏∏7 8
;
∏∏8 9
}
ππ 
}
∫∫ 
if
ºº 
(
ºº 

countFiles
ºº 
>
ºº  
$num
ºº! "
)
ºº" #
{
ΩΩ 
FileInfo
ææ 

fileDescom
ææ '
=
ææ( )
new
ææ* -
DirectoryInfo
ææ. ;
(
ææ; <
Environment
ææ< G
.
ææG H
CurrentDirectory
ææH X
+
ææY Z
$str
ææ[ n
)
ææn o
.
ææo p
GetFiles
ææp x
(
ææx y
)
ææy z
.
ææz { 
OrderByDescendingææ{ å
(ææå ç
fææç é
=>ææè ë
fææí ì
.ææì î
CreationTimeææî †
)ææ† °
.ææ° ¢
Firstææ¢ ß
(ææß ®
)ææ® ©
;ææ© ™
long
øø 
diffTimeFile
øø %
=
øø& '
DateAndTime
øø( 3
.
øø3 4
DateDiff
øø4 <
(
øø< =
DateInterval
øø= I
.
øøI J
Second
øøJ P
,
øøP Q

fileDescom
øøR \
.
øø\ ]
CreationTime
øø] i
,
øøi j
DateTime
øøk s
.
øøs t
Now
øøt w
)
øøw x
;
øøx y
if
¿¿ 
(
¿¿ 
diffTimeFile
¿¿ $
<=
¿¿% '
$num
¿¿( *
&&
¿¿+ -
!
¿¿. /

fileDescom
¿¿/ 9
.
¿¿9 :
FullName
¿¿: B
.
¿¿B C
Equals
¿¿C I
(
¿¿I J
fileDownloadInfo
¿¿J Z
.
¿¿Z [
FullName
¿¿[ c
)
¿¿c d
)
¿¿d e
ZipFile
¡¡ 
.
¡¡  !
CreateFromDirectory
¡¡  3
(
¡¡3 4
Environment
¡¡4 ?
.
¡¡? @
CurrentDirectory
¡¡@ P
+
¡¡Q R
$str
¡¡S f
,
¡¡f g
destinyPath
¡¡h s
+
¡¡t u
$str
¡¡v |
)
¡¡| }
;
¡¡} ~
}
√√ 
	Directory
≈≈ 
.
≈≈ 
Delete
≈≈  
(
≈≈  !
Environment
≈≈! ,
.
≈≈, -
CurrentDirectory
≈≈- =
+
≈≈> ?
$str
≈≈@ S
,
≈≈S T
true
≈≈U Y
)
≈≈Y Z
;
≈≈Z [
return
∆∆ 
true
∆∆ 
;
∆∆ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
…… 
if
   
(
   
logger
   
!=
   
null
   "
)
  " #
logger
ÀÀ 
.
ÀÀ 
Error
ÀÀ  
(
ÀÀ  !
string
ÀÀ! '
.
ÀÀ' (
Format
ÀÀ( .
(
ÀÀ. /
$str
ÀÀ/ c
,
ÀÀc d

MethodBase
ÀÀe o
.
ÀÀo p
GetCurrentMethodÀÀp Ä
(ÀÀÄ Å
)ÀÀÅ Ç
.ÀÀÇ É
NameÀÀÉ á
,ÀÀá à
exÀÀâ ã
.ÀÀã å
MessageÀÀå ì
)ÀÀì î
)ÀÀî ï
;ÀÀï ñ
return
ÃÃ 
false
ÃÃ 
;
ÃÃ 
}
ÕÕ 
}
ŒŒ 	
private
““ 
void
““ (
CreateFileReportNoDownload
““ /
(
““/ 0
List
““0 4
<
““4 5
Comic
““5 :
>
““: ;
comics
““< B
,
““B C
ILog
““D H
logger
““I O
)
““O P
{
”” 	
try
‘‘ 
{
’’ 
string
÷÷ 
docPath
÷÷ 
=
÷÷  
Environment
÷÷! ,
.
÷÷, -
CurrentDirectory
÷÷- =
+
÷÷> ?
$str
÷÷@ Z
;
÷÷Z [
using
◊◊ 
StreamWriter
◊◊ "

outputFile
◊◊# -
=
◊◊. /
File
◊◊0 4
.
◊◊4 5

AppendText
◊◊5 ?
(
◊◊? @
docPath
◊◊@ G
)
◊◊G H
;
◊◊H I

outputFile
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ $
(
ÿÿ$ %
Comic
ÿÿ% *
.
ÿÿ* +

Serializer
ÿÿ+ 5
(
ÿÿ5 6
comics
ÿÿ6 <
)
ÿÿ< =
+
ÿÿ> ?
$str
ÿÿ@ D
)
ÿÿD E
;
ÿÿE F
}
ŸŸ 
catch
⁄⁄ 
(
⁄⁄ 
	Exception
⁄⁄ 
ex
⁄⁄ 
)
⁄⁄  
{
€€ 
if
‹‹ 
(
‹‹ 
logger
‹‹ 
!=
‹‹ 
null
‹‹ "
)
‹‹" #
logger
›› 
.
›› 
Error
››  
(
››  !
string
››! '
.
››' (
Format
››( .
(
››. /
$str
››/ c
,
››c d

MethodBase
››e o
.
››o p
GetCurrentMethod››p Ä
(››Ä Å
)››Å Ç
.››Ç É
Name››É á
,››á à
ex››â ã
.››ã å
Message››å ì
)››ì î
)››î ï
;››ï ñ
}
ﬁﬁ 
}
ﬂﬂ 	
private
‡‡ 
void
‡‡ &
CreateFileReportNoRename
‡‡ -
(
‡‡- .
List
‡‡. 2
<
‡‡2 3
Comic
‡‡3 8
>
‡‡8 9
comics
‡‡: @
,
‡‡@ A
ILog
‡‡B F
logger
‡‡G M
)
‡‡M N
{
·· 	
try
‚‚ 
{
„„ 
string
‰‰ 
docPath
‰‰ 
=
‰‰  
Environment
‰‰! ,
.
‰‰, -
CurrentDirectory
‰‰- =
+
‰‰> ?
$str
‰‰@ X
;
‰‰X Y
using
ÂÂ 
StreamWriter
ÂÂ "

outputFile
ÂÂ# -
=
ÂÂ. /
File
ÂÂ0 4
.
ÂÂ4 5

AppendText
ÂÂ5 ?
(
ÂÂ? @
docPath
ÂÂ@ G
)
ÂÂG H
;
ÂÂH I

outputFile
ÊÊ 
.
ÊÊ 
	WriteLine
ÊÊ $
(
ÊÊ$ %
Comic
ÊÊ% *
.
ÊÊ* +

Serializer
ÊÊ+ 5
(
ÊÊ5 6
comics
ÊÊ6 <
)
ÊÊ< =
+
ÊÊ> ?
$str
ÊÊ@ D
)
ÊÊD E
;
ÊÊE F
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÈÈ 
if
ÍÍ 
(
ÍÍ 
logger
ÍÍ 
!=
ÍÍ 
null
ÍÍ "
)
ÍÍ" #
logger
ÎÎ 
.
ÎÎ 
Error
ÎÎ  
(
ÎÎ  !
string
ÎÎ! '
.
ÎÎ' (
Format
ÎÎ( .
(
ÎÎ. /
$str
ÎÎ/ c
,
ÎÎc d

MethodBase
ÎÎe o
.
ÎÎo p
GetCurrentMethodÎÎp Ä
(ÎÎÄ Å
)ÎÎÅ Ç
.ÎÎÇ É
NameÎÎÉ á
,ÎÎá à
exÎÎâ ã
.ÎÎã å
MessageÎÎå ì
)ÎÎì î
)ÎÎî ï
;ÎÎï ñ
}
ÏÏ 
}
ÌÌ 	
private
ÓÓ 
string
ÓÓ "
CreateFileReportNews
ÓÓ +
(
ÓÓ+ ,
List
ÓÓ, 0
<
ÓÓ0 1
Comic
ÓÓ1 6
>
ÓÓ6 7
comics
ÓÓ8 >
,
ÓÓ> ?
ILog
ÓÓ@ D
logger
ÓÓE K
)
ÓÓK L
{
ÔÔ 	
try
 
{
ÒÒ 
string
ÚÚ 
docPath
ÚÚ 
=
ÚÚ  
Environment
ÚÚ! ,
.
ÚÚ, -
CurrentDirectory
ÚÚ- =
+
ÚÚ> ?
string
ÚÚ@ F
.
ÚÚF G
Format
ÚÚG M
(
ÚÚM N
$str
ÚÚN l
,
ÚÚl m
DateTime
ÚÚn v
.
ÚÚv w
Now
ÚÚw z
)
ÚÚz {
;
ÚÚ{ |
using
ÛÛ 
StreamWriter
ÛÛ "

outputFile
ÛÛ# -
=
ÛÛ. /
File
ÛÛ0 4
.
ÛÛ4 5

AppendText
ÛÛ5 ?
(
ÛÛ? @
docPath
ÛÛ@ G
)
ÛÛG H
;
ÛÛH I

outputFile
ÙÙ 
.
ÙÙ 
	WriteLine
ÙÙ $
(
ÙÙ$ %
Comic
ÙÙ% *
.
ÙÙ* +

Serializer
ÙÙ+ 5
(
ÙÙ5 6
comics
ÙÙ6 <
,
ÙÙ< =
false
ÙÙ> C
)
ÙÙC D
)
ÙÙD E
;
ÙÙE F
return
ıı 
docPath
ıı 
;
ıı 
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
¯¯ 
if
˘˘ 
(
˘˘ 
logger
˘˘ 
!=
˘˘ 
null
˘˘ "
)
˘˘" #
logger
˙˙ 
.
˙˙ 
Error
˙˙  
(
˙˙  !
string
˙˙! '
.
˙˙' (
Format
˙˙( .
(
˙˙. /
$str
˙˙/ c
,
˙˙c d

MethodBase
˙˙e o
.
˙˙o p
GetCurrentMethod˙˙p Ä
(˙˙Ä Å
)˙˙Å Ç
.˙˙Ç É
Name˙˙É á
,˙˙á à
ex˙˙â ã
.˙˙ã å
Message˙˙å ì
)˙˙ì î
)˙˙î ï
;˙˙ï ñ
return
˚˚ 
null
˚˚ 
;
˚˚ 
}
¸¸ 
}
˝˝ 	
private
˛˛ 
void
˛˛ $
CreateFileLastDownload
˛˛ +
(
˛˛+ ,
string
˛˛, 2
titleComics
˛˛3 >
,
˛˛> ?
ILog
˛˛@ D
logger
˛˛E K
)
˛˛K L
{
ˇˇ 	
try
ÄÄ 
{
ÅÅ 
string
ÇÇ 
docPath
ÇÇ 
=
ÇÇ  
Environment
ÇÇ! ,
.
ÇÇ, -
CurrentDirectory
ÇÇ- =
+
ÇÇ> ?
$str
ÇÇ@ [
;
ÇÇ[ \
using
ÉÉ 
StreamWriter
ÉÉ "

outputFile
ÉÉ# -
=
ÉÉ. /
new
ÉÉ0 3
StreamWriter
ÉÉ4 @
(
ÉÉ@ A
docPath
ÉÉA H
)
ÉÉH I
;
ÉÉI J

outputFile
ÑÑ 
.
ÑÑ 
	WriteLine
ÑÑ $
(
ÑÑ$ %
titleComics
ÑÑ% 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
áá 
if
àà 
(
àà 
logger
àà 
!=
àà 
null
àà "
)
àà" #
logger
ââ 
.
ââ 
Error
ââ  
(
ââ  !
string
ââ! '
.
ââ' (
Format
ââ( .
(
ââ. /
$str
ââ/ c
,
ââc d

MethodBase
ââe o
.
ââo p
GetCurrentMethodââp Ä
(ââÄ Å
)ââÅ Ç
.ââÇ É
NameââÉ á
,ââá à
exâââ ã
.ââã å
Messageââå ì
)ââì î
)ââî ï
;ââï ñ
}
ää 
}
ãã 	
private
åå 
void
åå )
CreateFileReportCollections
åå 0
(
åå0 1
List
åå1 5
<
åå5 6
string
åå6 <
>
åå< =
list
åå> B
,
ååB C
ILog
ååD H
logger
ååI O
)
ååO P
{
çç 	
try
éé 
{
èè 
string
êê 
docPath
êê 
=
êê  
Environment
êê! ,
.
êê, -
CurrentDirectory
êê- =
+
êê> ?
$str
êê@ ^
;
êê^ _
using
ëë 
StreamWriter
ëë "

outputFile
ëë# -
=
ëë. /
new
ëë0 3
StreamWriter
ëë4 @
(
ëë@ A
docPath
ëëA H
)
ëëH I
;
ëëI J
foreach
íí 
(
íí 
string
íí 
name
íí  $
in
íí% '
list
íí( ,
)
íí, -

outputFile
ìì 
.
ìì 
	WriteLine
ìì (
(
ìì( )
name
ìì) -
)
ìì- .
;
ìì. /
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ññ 
if
óó 
(
óó 
logger
óó 
!=
óó 
null
óó "
)
óó" #
logger
òò 
.
òò 
Error
òò  
(
òò  !
string
òò! '
.
òò' (
Format
òò( .
(
òò. /
$str
òò/ c
,
òòc d

MethodBase
òòe o
.
òòo p
GetCurrentMethodòòp Ä
(òòÄ Å
)òòÅ Ç
.òòÇ É
NameòòÉ á
,òòá à
exòòâ ã
.òòã å
Messageòòå ì
)òòì î
)òòî ï
;òòï ñ
}
ôô 
}
öö 	
private
õõ 
string
õõ 
ReadLastDownload
õõ '
(
õõ' (
ILog
õõ( ,
logger
õõ- 3
)
õõ3 4
{
úú 	
try
ùù 
{
ûû 
string
üü 
docPath
üü 
=
üü  
Environment
üü! ,
.
üü, -
CurrentDirectory
üü- =
+
üü> ?
$str
üü@ [
;
üü[ \
if
†† 
(
†† 
!
†† 
new
†† 
FileInfo
†† !
(
††! "
docPath
††" )
)
††) *
.
††* +
Exists
††+ 1
)
††1 2
return
††3 9
null
††: >
;
††> ?
using
°° 
StreamReader
°° "
file
°°# '
=
°°( )
new
°°* -
StreamReader
°°. :
(
°°: ;
docPath
°°; B
)
°°B C
;
°°C D
return
¢¢ 
file
¢¢ 
.
¢¢ 
ReadLine
¢¢ $
(
¢¢$ %
)
¢¢% &
;
¢¢& '
}
££ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
•• 
if
¶¶ 
(
¶¶ 
logger
¶¶ 
!=
¶¶ 
null
¶¶ "
)
¶¶" #
logger
ßß 
.
ßß 
Error
ßß  
(
ßß  !
string
ßß! '
.
ßß' (
Format
ßß( .
(
ßß. /
$str
ßß/ c
,
ßßc d

MethodBase
ßße o
.
ßßo p
GetCurrentMethodßßp Ä
(ßßÄ Å
)ßßÅ Ç
.ßßÇ É
NameßßÉ á
,ßßá à
exßßâ ã
.ßßã å
Messageßßå ì
)ßßì î
)ßßî ï
;ßßï ñ
return
®® 
null
®® 
;
®® 
}
©© 
}
™™ 	
private
´´ 
void
´´ (
CreateFileReportCollection
´´ /
(
´´/ 0
List
´´0 4
<
´´4 5
Comic
´´5 :
>
´´: ;
comics
´´< B
,
´´B C
string
´´D J
title
´´K P
,
´´P Q
ILog
´´R V
logger
´´W ]
)
´´] ^
{
¨¨ 	
try
≠≠ 
{
ÆÆ 
if
ØØ 
(
ØØ 
!
ØØ 
new
ØØ 
DirectoryInfo
ØØ &
(
ØØ& '
Environment
ØØ' 2
.
ØØ2 3
CurrentDirectory
ØØ3 C
+
ØØD E
$str
ØØF Q
)
ØØQ R
.
ØØR S
Exists
ØØS Y
)
ØØY Z
	Directory
∞∞ 
.
∞∞ 
CreateDirectory
∞∞ -
(
∞∞- .
Environment
∞∞. 9
.
∞∞9 :
CurrentDirectory
∞∞: J
+
∞∞K L
$str
∞∞M X
)
∞∞X Y
;
∞∞Y Z
if
±± 
(
±± 
!
±± 
new
±± 
DirectoryInfo
±± &
(
±±& '
Environment
±±' 2
.
±±2 3
CurrentDirectory
±±3 C
+
±±D E
$str
±±F \
)
±±\ ]
.
±±] ^
Exists
±±^ d
)
±±d e
	Directory
≤≤ 
.
≤≤ 
CreateDirectory
≤≤ -
(
≤≤- .
Environment
≤≤. 9
.
≤≤9 :
CurrentDirectory
≤≤: J
+
≤≤K L
$str
≤≤M c
)
≤≤c d
;
≤≤d e
string
≥≥ 
docPath
≥≥ 
=
≥≥  
Environment
≥≥! ,
.
≥≥, -
CurrentDirectory
≥≥- =
+
≥≥> ?
$str
≥≥@ W
+
≥≥X Y
title
≥≥Z _
.
≥≥_ `
Replace
≥≥` g
(
≥≥g h
$str
≥≥h k
,
≥≥k l
$str
≥≥m p
)
≥≥p q
.
≥≥q r
Replace
≥≥r y
(
≥≥y z
$str
≥≥z }
,
≥≥} ~
$str≥≥ É
)≥≥É Ñ
+≥≥Ö Ü
$str≥≥á ç
;≥≥ç é
using
¥¥ 
StreamWriter
¥¥ "

outputFile
¥¥# -
=
¥¥. /
File
¥¥0 4
.
¥¥4 5

AppendText
¥¥5 ?
(
¥¥? @
docPath
¥¥@ G
)
¥¥G H
;
¥¥H I

outputFile
µµ 
.
µµ 
	WriteLine
µµ $
(
µµ$ %
Comic
µµ% *
.
µµ* +

Serializer
µµ+ 5
(
µµ5 6
comics
µµ6 <
)
µµ< =
)
µµ= >
;
µµ> ?
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
if
ππ 
(
ππ 
logger
ππ 
!=
ππ 
null
ππ "
)
ππ" #
logger
∫∫ 
.
∫∫ 
Error
∫∫  
(
∫∫  !
string
∫∫! '
.
∫∫' (
Format
∫∫( .
(
∫∫. /
$str
∫∫/ c
,
∫∫c d

MethodBase
∫∫e o
.
∫∫o p
GetCurrentMethod∫∫p Ä
(∫∫Ä Å
)∫∫Å Ç
.∫∫Ç É
Name∫∫É á
,∫∫á à
ex∫∫â ã
.∫∫ã å
Message∫∫å ì
)∫∫ì î
)∫∫î ï
;∫∫ï ñ
}
ªª 
}
ºº 	
private
¿¿ 
string
¿¿ 

FormatSize
¿¿ !
(
¿¿! "
long
¿¿" &
bytes
¿¿' ,
)
¿¿, -
{
¡¡ 	
decimal
¬¬ 
number
¬¬ 
=
¬¬ 
bytes
¬¬ "
;
¬¬" #
while
√√ 
(
√√ 
Math
√√ 
.
√√ 
Round
√√ 
(
√√ 
number
√√ $
/
√√% &
$num
√√' +
)
√√+ ,
>=
√√- /
$num
√√0 1
)
√√1 2
number
ƒƒ 
/=
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
return
≈≈ 
string
≈≈ 
.
≈≈ 
Format
≈≈  
(
≈≈  !
$str
≈≈! )
,
≈≈) *
number
≈≈+ 1
)
≈≈1 2
;
≈≈2 3
}
∆∆ 	
}
»» 
}…… 